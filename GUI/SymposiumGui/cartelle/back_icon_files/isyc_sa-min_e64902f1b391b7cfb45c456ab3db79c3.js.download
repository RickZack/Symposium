YUI.add("search-assist-advanced-suggestions-plugin",function(c){var f,m=function(){m.superclass.constructor.apply(this,arguments)},a=function(a){this.suggestionText=a.suggestionText;this.label=a.label;this._generateMarkup()},b=function(a){this.value=a.value;this.label=a.label;this._generateMarkup()};a.prototype={_generateMarkup:function(){this.markup='<span class="'+this.cssClass+'">'+this.label+"</span>"},toString:function(){return this.suggestionText},cssClass:"site suggestionToken"};b.prototype=
{_generateMarkup:function(){this.markup='<span class="'+this.cssClass+'">'+this.label+"</span>"},toString:function(){return""},onSubmit:function(a){a.target.evtFacade.target.ancestor("form").append('<input type="hidden" name="vl" value="'+this.value+'"/>');a.target.evtFacade.target.ancestor("form").append('<input type="hidden" name="fl" value="1"/>')},cssClass:"country suggestionToken"};f={database:{french:new b({suggestionText:"",value:"lang_fr",label:"in French"}),ebay:new a({suggestionText:"site:ebay.com",
label:"Ebay.com"}),craigslist:new a({suggestionText:"site:craigslist.org",label:"Craigslist.org"}),amazon:new a({suggestionText:"site:amazon.com",label:"Amazon.com"}),zillow:new a({suggestionText:"site:zillow.com",label:"Zillow.com"}),cnn:new a({suggestionText:"site:cnn.com",label:"Cnn.com"}),mashable:new a({suggestionText:"site:mashable.com",label:"Mashable.com"}),reddit:new a({suggestionText:"site:reddit.com",label:"Reddit.com"})},getSuggestions:function(a){var b,g=c.Lang.trim(a).split(" "),h=g.length,
f={suggestions:[],text:""};for(a=0;h>a;a++)(b=this.database[g[a].toLowerCase()])&&(g.splice(a,1),h--,a--,f.suggestions.push(b));return f.text=g.join(" "),f}};c.mix(m,{NAME:"search-assist-advanced-suggestions-plugin",NS:"AdvancedSuggestions",ATTRS:{}});c.extend(m,c.Plugin.Base,{initializer:function(){c.log("instantiating the advanced Search plugin","debug");this.doAfter("suggest-markup-has-been-attached-to-DOM",this._prependAdvancedSuggestions);this.doAfter("zero-suggestions-rendered-to-DOM",this._prependAdvancedSuggestions)},
_prependAdvancedSuggestions:function(a){var b,g=this.get("host"),h=f.getSuggestions(a.query),k={markup:"",suggestionText:h.text+" ",prepend:!0},m=h.suggestions.length;for(a=0;m>a;a+=1)b=h.suggestions[a],k.markup+=b.markup+" ",k.suggestionText+=b+" ",b.onSubmit&&g.on("search-assist-form-submit",c.bind(b.onSubmit,b));h.suggestions.length&&(k.markup+=h.text,g.addSuggestion(k))}});c.AdvancedSuggestionsPlugin=m},"1.0.0",{requires:["plugin","base-pluginhost"]});
YUI.add("search-assist-aria-plugin",function(c){var f;f=function(){f.superclass.constructor.apply(this,arguments)};c.mix(f,{NAME:"search-assist-aria-plugin",NS:"aria",ATTRS:{suggestionBoxClosedText:{value:"Suggestion box closed"},newSuggestionsShownText:{setter:function(c){return c.trending?""+c.count+" new trending suggestions shown":""+c.count+" new suggestions shown"}},suggestionSelectedText:{setter:function(c){var a="";return c&&(a="suggestion selected, "+c+", press arrow-right key to autocomplete or, press enter to search"),
a}}}});c.extend(f,c.Plugin.Base,{initializer:function(){this.aria_plugin_subscr={};var f;f=this.get("host");c.log("instantiating the ARIA plugin #######################","debug");!1===f.get("quietMode")&&f.get("searchBox").setAttribute("aria-haspopup",!0);this.aria_plugin_subscr.SA_ARIA_EVT_SUGGEST_MARKUP_RENDERED=this.doAfter("suggest-markup-has-been-attached-to-DOM",this._handleTrayHasBeenRendered);this.aria_plugin_subscr.EVT_SUGGESTIONS_HAS_BEEN_REMOVED=this.doAfter("search-assist-tray-removed",
this._handleTrayHasBeenRemoved);this.aria_plugin_subscr.EVT_SUGGESTION_SELECTED=this.doAfter("search-assist-suggestion-selected",this._handleSuggestionSelected);f=this._liveRegion=c.Node.create('<div role="status" class="sa-aria-live-region" aria-live="polite"></div>');this.aria_plugin_subscr.NODE_LIVE_REGION=f;f.setStyles({position:"absolute",left:"-9999px"});c.one("body").append(f)},_handleTrayHasBeenRemoved:function(){this._liveRegion&&(this._liveRegion.setContent("<p>"+this.get("suggestionBoxClosedText")+
"</p>"),this._liveRegion.setAttribute("aria-expanded","false"))},_handleTrayHasBeenRendered:function(f){var a,b,e=this.get("host").get("tray"),d=e.Node,e=e.len;d&&(a=d.all("> ul"),b=d.all("> ul *"),c.Lang.isNumber(e)?(f.trending?(this.set("newSuggestionsShownText",{count:e,trending:!0}),this._liveRegion.setContent("<p>"+this.get("newSuggestionsShownText")+"</p>")):(this.set("newSuggestionsShownText",{count:e,trending:!1}),this._liveRegion.setContent("<p>"+this.get("newSuggestionsShownText")+"</p>")),
this._liveRegion.setAttribute("aria-expanded","true")):this._liveRegion.setAttribute("aria-expanded","false"),a.each(function(a){a.setAttribute("role","listbox")}),b.each(function(a){a.setAttribute("role","option")}))},_handleSuggestionSelected:function(c){this._liveRegion&&c.suggestion&&(this.set("suggestionSelectedText",c.suggestion),this._liveRegion.setContent("<p>"+this.get("suggestionSelectedText")+"</p>"))},destroy:function(){var f,a=this.aria_plugin_subscr;if(a)for(f in a)a.hasOwnProperty(f)&&
(c.log("aria: unplugging "+f,"debug"),c.Lang.isFunction(a[f].purge)&&a[f].purge(),c.Lang.isFunction(a[f].detach)&&a[f].detach(),c.Lang.isFunction(a[f].remove)&&a[f].remove(),delete a[f])}});c.namespace("SEARCHASSIST").AriaPlugin=f},"1.0.0",{requires:["plugin","base-pluginhost"]});
YUI.add("search-assist-client",function(c,f){var m="client",m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"Sa-Client",ATTRS:{}});c.SEARCHASSIST.CLIENT=c.Base.create(m,c.SEARCHASSIST.CORE,[c.SEARCHASSIST.TRAY,c.SEARCHASSIST.MOBILE,c.SEARCHASSIST.NAVIGATE,c.SEARCHASSIST.LINKTRACK],{submitListeners:[],clientInit:function(){this.publishClientEvts()},initializer:function(a){var b=this.get("searchBox");c.log("instantiating CLIENT","debug",f);this.get("quietMode")||this.clientInit(a);
this._confidence=0;this._prevSuggestion="";this._confidenceCounter=0;b&&b.hasAttribute("autofocus")&&b.focus()},setEventsForFakeBox:function(){var a=this,b=this.get("searchBox"),e=this._allSubscr||{};e._srchNodeKeyDownFakeBox=b.on("keydown",function(b){var e,h,f;!a.get("fakeBoxNode").get("value")||9!==b.keyCode&&39!==b.keyCode||(e=a.getQuery(),a.logAutoCompletion(e,a.get("fakeBoxNode").get("value"),1));a.get("fakeBox")&&a.get("fakeBox").autoCompleteOnReturnKey&&13===b.keyCode&&a.get("fakeBoxNode").get("value")&&
a.get("searchBox").set("value",a.get("fakeBoxNode").get("value"));c.UA.webkit&&13===b.keyCode&&a.get("fakeBox")&&(h=a.get("fakeBoxNode"),f=c.one("#fbdum"),h&&h.remove(),f&&f.remove())});e._srchNodeKeyUpFakeBox=b.on("keyup",function(b){c.UA.webkit&&13===b.keyCode&&a.get("fakeBox")&&(a.get("fakeBoxNode")||a.get("ieTillEight")||a.initFakeBoxNode());40!==b.keyCode&&38!==b.keyCode&&39!==b.keyCode&&37!==b.keyCode&&9!==b.keyCode||a.resetFBox()});c.one("#fbdum").on("click",function(){a.resetFBox();b.focus()});
this.on("zero-suggestions-rendered-to-DOM",function(){a.resetFBox()});this.on("suggest-markup-has-been-attached-to-DOM",function(b){var c=b.firstSuggestion;b=b.query;var e=this.get("fakeBoxNode");return e&&e.get("value")&&0!==e.get("value").indexOf(b,0)&&a.resetFBox(),""===b||a._prevSuggestion!==c.toLowerCase()?void a.resetFBox():void 0});this.on("search-assist-new-confidence",function(b){""!==b.query&&(a.ghost&&a.ghost.cancel(),a.ghost=c.later(400,this,function(){a.ghostAutoComplete(b)}))});b.on("click",
function(){a.resetFBox()});this.get("ieTillEight")||b.get("parentNode").on("click",function(){b.focus()})},initFakeBoxNode:function(){var a,b=this.get("searchBox");a="";var c=this.get("fakeBox").fakeBoxHintText;this.get("fakeBox").fakeBoxHint&&c&&0<c.length&&(a='<span id="fakeBoxHint" class="fakeBoxHint">'+c+"</span>");b.get("parentNode").append('<input id="fakeBox"type="text" class="fakebox" aria-hidden="true" autocomplete="off" autocorrect="off" dir="ltr" />');b.get("parentNode").append('<div id="fbdum" style="position:absolute; left:0; right:0; top:0; bottom:0;z-index:-1"></div>');
a&&b.get("parentNode").append(a);a=this.get("fakeBoxNode");a.setStyles({"border-radius":b.getStyle("border-radius"),margin:b.getStyle("margin"),fontSize:b.getStyle("fontSize"),fontFamily:b.getStyle("fontFamily"),paddingLeft:b.getStyle("paddingLeft"),paddingRight:b.getStyle("paddingRight"),paddingTop:b.getStyle("paddingTop"),paddingBottom:b.getStyle("paddingBottom"),marginLeft:b.getStyle("marginLeft"),marginTop:b.getStyle("marginTop"),marginBottom:b.getStyle("marginBottom"),marginRight:b.getStyle("marginRight"),
borderLeftWidth:b.getStyle("borderLeftWidth"),borderRightWidth:b.getStyle("borderRightWidth"),borderTopWidth:b.getStyle("borderTopWidth"),borderBottomWidth:b.getStyle("borderBottomWidth"),borderLeftStyle:b.getStyle("borderLeftStyle"),borderRightStyle:b.getStyle("borderRightStyle"),borderTopStyle:b.getStyle("borderTopStyle"),borderBottomStyle:b.getStyle("borderBottomStyle"),borderLeftColor:b.getStyle("borderLeftColor"),borderRightColor:b.getStyle("borderRightColor"),borderTopColor:b.getStyle("borderTopColor"),
borderBottomColor:b.getStyle("borderBottomColor"),zIndex:"-1"});a.blur();a.setAttribute("disabled",!0);a.setAttribute("tabindex","-1");b.setStyle("backgroundColor","transparent");b.setAttribute("onfocus","this.value = this.value;")},initGhostBox:function(){this.get("ieTillEight")||this.get("fakeBoxNode")||(this.initFakeBoxNode(),this.setEventsForFakeBox())},initSpellCheck:function(){var a,b=this.get("searchBox");b.get("parentNode").append('<div id="spellCheckBox"></div>');a=this.get("spellCheckNode");
a.setStyles({height:b.getStyle("height"),fontSize:b.getStyle("font-size"),paddingLeft:b.getStyle("padding-left"),fontFamily:b.getStyle("font-family"),margin:b.getStyle("margin"),fontWeight:b.getStyle("font-weight"),lineHeight:b.getStyle("height"),letterSpacing:b.getStyle("letter-spacing")});a.blur();a.setAttribute("disabled",!0);a.setAttribute("tabindex","-1");b.setStyle("backgroundColor","transparent");b.setAttribute("onfocus","this.value = this.value;")},initConfidence:function(){var a=this;this.on("suggest-markup-has-been-attached-to-DOM",
function(b){var e=b.firstSuggestion,d=b.query;e&&d&&0===e.toLowerCase().indexOf(d.toLowerCase(),0)?(a._confidence=10-(e.length-d.length)/e.length*10,a._prevSuggestion===e.toLowerCase()?10>=a._confidenceCounter&&(a._confidenceCounter+=1):a._confidenceCounter=0,0<a._confidenceCounter&&(a._confidence+=a._confidenceCounter,10<=a._confidence&&(a._confidence=10))):(a._confidenceCounter=0,a._confidence=0);e&&(a._prevSuggestion=e.toLowerCase());b._confidence=a._confidence;c.log("confidence of suggestion close to query: "+
a._confidence,"debug");a.fire("search-assist-new-confidence",b)})},adjustCase:function(a,b){return a&&b?a+b.substr(a.length):""},spellCheck:function(a){var b,e=this.get("spellCheckNode"),d=this.getQuery(),g="[]",h=[],k=0;if(0===d.length)return void this.clearSpellCheck();if(a.spchk){c.log("Performing spell check","debug",f);try{if(g=c.JSON.parse(a.spchk),0!==g.length%2)return void this.clearSpellCheck();for(b=0;b<g.length;b+=2)h.push(d.substring(k,g[b])),k=g[b],h.push('<span class="spellcheck">'),
h.push(d.substring(k,g[b+1]+1)),h.push("</span>"),k=g[b+1]+1;h.push(d.substring(k));h=h.join("");e.setHTML(h)}catch(l){this.clearSpellCheck(),c.log("Failed to parse spell check object","debug",f)}}else this.clearSpellCheck()},clearSpellCheck:function(){this.get("spellCheckNode").setHTML("")},ghostAutoComplete:function(a){var b,e,d,g,h=this.get("fakeBoxNode"),k=this.get("fakeBoxHintNode"),l=this.getQuery(),u=l.toLowerCase(),m=20;return e=this._queryWidth,d=this.get("searchBox").get("clientWidth")-
this._sbxPadLeftInt,e>d-m?(c.log("textWidth:"+e+"greater than sbxWidth:"+d,"debug",f),void this.resetFBox()):(k&&(m=k.get("offsetWidth")+100),g=d-e,b=a.firstSuggestion,void(h&&""!==u&&!this.isTrayTypeTrending()&&4<this._confidence?(h.set("value",b),b=this.adjustCase(l,b),h.set("value",b),this.fire("search-assist-ghost-box-rendered",a),b!==this.get("searchBox").get("value")&&this.resetTabTrack(),k&&(this._firsttimehint?m>g&&this.resetFBoxHint(!0):g>=m&&(k.addClass("show-fake-box-hint"),this._firsttimehint=
c.later(5E3,this,function(){k.removeClass("show-fake-box-hint")})))):this.resetFBox()))},resetFBoxHint:function(a){var b=this.get("fakeBoxNode"),c=this.get("fakeBoxHintNode");b&&c&&this._firsttimehint&&(this._firsttimehint.cancel(),c.removeClass("show-fake-box-hint"),a||(this._firsttimehint=!1))},resetFBox:function(){var a=this.get("fakeBoxNode");a&&(a.set("value",""),a.blur())},registerBoxEvents:function(){var a,b=this,e=b.get("searchBox"),d=this,g=this,h=this,k=b.get("currentDevice"),l=this._allSubscr;
b.get("spellCheck")&&this.initSpellCheck();"desktop"===k&&b.get("fakeBox")&&this.initGhostBox();"desktop"===k&&this.initConfidence();e?(c.log("searchNode is "+e,"debug",f),l._clientSrchNodeOnClick=e.on("click",function(a){c.log("click caught on searchnode","debug",f);b.get("mobileExpandMode")&&(a.stopPropagation(),a.preventDefault());g.handleEventOnSearchBox(a,"click")}),this.get("gecko")&&(c.log("gecko user agent..","degug",f),a=function(){return d._geckoGeneralState?void(d._geckoGeneralState=!1):
(d.fireInTheHole(),void(d._geckoGeneralState=!1))},l._clientSrchValChangeGecko=e.on("valueChange",function(b){var e,g;return d._grog&&d._grog.cancel(),d._geckoGeneralState?(d._geckoGeneralState=!1,d._valueChangeFail&&d._valueChangeFail.cancel(),void(d._valueChangeFail=c.later(100,this,function(){d._geckoCaughtKeyUp?d._geckoCaughtKeyUp=!1:38!==d._geckoCharCodeOnKeyDown&&40!==d._geckoCharCodeOnKeyDown&&d.fireInTheHole()}))):(e=d._geckoCharCodeOnKeyDown,g=38===e||40===e||39===e||37===e||8===e||32===
e,void(g||(d._grog=c.later(20,this,function(){a(b)}))))}),l._clientSrchKeyDownNativeGecko=e.on("keydown",function(a){d._geckoCharCodeOnKeyDown=a.charCode;d._geckoGeneralState=!0;d._geckoCaughtKeyUp=!1}),e.on("keyup",function(a){c.log("keyup: e.keyCode:"+a.keyCode,"debug");d._geckoGeneralState=!0;d._geckoCaughtKeyUp=!0})),l._clientSrchKeyUpNative=e.on("keyup",function(a){return 38===a.charCode||40===a.charCode||229===a.charCode||197===a.charCode?(c.log("arrow up / arrow down on keyup, as good as no keyup for native input case",
"debug"),void(d._nativeTrayKeyup=!1)):(d._nativeTrayKeyup=!0,void c.log("keyup: e.charCode:"+a.charCode,"debug"))}),l._clientSrchKeyDownNative=e.on("keydown",function(a){return d._nativeTrayKeyup=!1,c.log("keydown: e.keyCode:"+a.keyCode,"debug"),!0!==d._native||32!==a.charCode&&229!==a.charCode&&197!==a.charCode?(197===a.keyCode||229===a.keyCode?(c.log("keydown: input from native keyboard","debug"),d._native=!0):(d._native=!1,c.log("keydown: input from normal keyboard","debug")),void((40===a.charCode||
38===a.charCode)&&(d._d=this.get("value")))):void c.log("native is already true and keypressed was either space or native input key","debug")}),l._clientSrchValChangeNative=e.on("valueChange",function(a){c.log("valueChange:"+a.newVal,"debug");d._c=a.newVal;d._p=a.prevVal;d._s=this.get("value");d._native&&!1===d._nativeTrayKeyup&&(c.log("updating tray","debug"),c.log("_nativeTrayKeyup:"+d._nativeTrayKeyup,"debug"),c.log("_native:"+d._native,"debug"),d.fireInTheHole())}),l._clientSrchValChange=e.on("valueChange",
function(a){""===a.newVal&&b.isTrendingEnabled()&&h.fireInTheHole(a)}),l._clientSrchNodeOnValueChange=e.on("valuechange",function(a){c.log("event-value change was captured, self.keydown = "+h.getKeyDownState(),"debug",f);var b=d.getQuery();!1===h.getKeyDownState()&&""===b&&(c.log("firing query emptiness","debug",f),this.fire("query-emptiness"));c.log("query wasnt empty on event-value-change","debug",f);g.handleEventOnSearchBox(a,"valuechange")})):c.log("srchNode not found","error",f);window.YAHOO&&
window.YAHOO.CryptoOb&&b.addSubmitListener(window.YAHOO.CryptoOb)},publishClientEvts:function(){var a=this._allSubscr||{};c.log("publishing Client events","debug",f);c.log("registering box event","debug",f);this.registerBoxEvents();a._eventFormSubmit=this.publish("search-assist-form-submit",{defaultFn:c.bind("_defEvtFormSubmit",this)})},addSubmitListener:function(a){this.submitListeners.push(a)},handleSubmit:function(a,b){var c=!1;try{for(var d=a.submitListeners,g=0;g<d.length&&!c;g++)c=d[g].handleSubmit(b)}catch(h){}c||
b.submit()},_defEvtFormSubmit:function(){this.get("preventFormSubmit")?c.log("*****************NOT submitting form ********************","debug"):(c.log("*****************************submitting form*******************","debug"),this.handleSubmit(this,this.get("searchForm").getDOMNode()))},trimEndSpace:function(a){var b;if(a){a=a.replace(/^\s+/,"");for(b=a.length-1;0<=b;--b)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a}return null},setSearchBoxVal:function(a){var b=this.get("searchBox");
b&&b.set("value",a)},handleEventOnSearchBox:function(a,b){var e=this.getQuery(),d=this.get("currentDevice"),g=this.isTrendingEnabled();if("desktop"===d){if("click"===b){if(c.log("desktop:event:"+b,"debug",f),this.isTrayOpen())return;""===e?g&&this.fireInTheHole(a):this.fireInTheHole(a)}if("keyup"===b)return c.log("desktop:event:"+b,"debug",f),void(""===e?g&&this.fireInTheHole(a):this.fireInTheHole(a));if("valuechange"===b||"query-emptiness"===b)return c.log("desktop:event:"+b,"debug",f),void(g?e&&
""!==e||(c.log("query is empty","debug",f),this.resetFBoxHint(!1),!1===this.getKeyDownState()&&(this.isTrayOpen()&&this.isTrayTypeTrending()?c.log("trending tray already open","debug",f):this.fireInTheHole(a))):e&&""!==e||(this.resetFBoxHint(!1),this.isTrayOpen()&&this.removeSuggestionsMarkup()))}"phone"!==d&&"tablet"!==d||this.handleMobileEventsOnSearchBox(a,b)},isStringEmpty:function(a){return a&&""!==a&&""!==this.trimEndSpace(a)?!1:!0},getQuery:function(){var a=this.get("searchBox"),b="";return a?
(b=a.get("value"),this.isStringEmpty(b)?"":b):void 0},addSuggestion:function(a){this.isRenderMode("tray")&&(a.mode="tray",this.addNewSuggestion(a))}})},"0.0.1",{requires:"search-assist search-assist-tray search-assist-mobile search-assist-linktrack search-assist-navigate cache base node-base jsonp json-stringify highlight-base event-valuechange escape event-outside event-flick node-style node-screen json-stringify cookie datasource datasource-jsonschema datasource-xmlschema datasource-arrayschema dataschema".split(" ")});
YUI.add("search-assist-config-panel-plugin",function(c,f){var m;m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"search-assist-config-panel-plugin",NS:"configui",ATTRS:{title:{valueFn:function(){var a=c.Node.create('<div class="sa-config-panel-title"> SA Config panel</div>');return this.get("panel").append(a),a.setStyles({background:"#fff",color:"#000",display:"block","border-bottom":"1px solid #ccc"}),c.one(".sa-config-panel-title")}},panel:{valueFn:function(){var a=c.Node.create('<div class="sa-config-panel"></div>');
return a.setStyles({display:"block",border:"1px solid #ccc",padding:"10px","box-shadow":"1px 2px 10px #ccc","border-radius":"2px",background:"#fff"}),a.hide(),c.one("body").prepend(a),c.one(".sa-config-panel")}},origToShow:{valueFn:function(){return this.get("host").get("configPanel").toShow}},toShow:{valueFn:function(){var a,b=this.get("host").get("configPanel").toShow,e=[],d=0;c.log(b,"debug");a=b.length;for(d=0;a>d;d+=1)e[b[d]]=!0;return c.log(e,"debug"),e}}}});c.extend(m,c.Plugin.Base,{initializer:function(){this.config_plugin_subscr=
{};c.log("instantiating the config plugin #######################","debug");this.isPanelHidden=!0;var a,b,e=this;a=this.get("origToShow");var d=c.one(".sa-config-panel");c.Array.each(a,function(a){var b=e.createCheckBox(a);b&&e.setCheckBox(b,a)});this.config_plugin_subscr.configTitle=this.get("title");this.config_plugin_subscr.panelWrapper=b=c.Node.create('<div class="sa-config-panel-wrapper"></div>');this.config_plugin_subscr.wrench=a=c.Node.create('<div class="icon-wrench-wrapper"></div>');this.config_plugin_subscr.configPanel=
d;a.setHTML('<span><i class="icon-wrench">setting</i></span>');d.wrap(b);b.prepend(a);b.setStyles({display:"inline-block",position:"fixed",right:"0","z-index":"2000"});a.setStyles({display:"block",cursor:"pointer",padding:"5px",color:"#bbb","font-size":"1.0em","float":"right"});a.on("click",function(){e.isPanelHidden?(this.addClass("icon-wrench-wrapper-active"),d.show(),e.isPanelHidden=!1):(d.hide(),this.removeClass("icon-wrench-wrapper-active"),e.isPanelHidden=!0)})},createCheckBox:function(a){var b,
e,d=this.get("panel");return void 0===this.get("host").get(a)?(c.log('invalid param name provided in configpanel array ["'+a+'"]',"error"),null):this.get("toShow")[a]?(b=this.config_plugin_subscr.param=c.Node.create('<input type="checkbox" class="sa-config-panel-'+a+'"" name="'+a+'" value="0">'),d.append(b),e=c.one(".sa-config-panel-"+a),e.wrap('<div class="'+a+'-wrapper"></div>'),c.one("."+a+"-wrapper").append("<span>"+a+"</span>"),e):void 0},setCheckBox:function(a,b){var c=this.get("host");c.get(b)?
a.set("checked",!0):a.set("checked",!1);this.config_plugin_subscr=a.on("click",function(){c.set(b,this.get("checked"))})},destroy:function(){var a,b=this.config_plugin_subscr;if(b)for(a in b)b.hasOwnProperty(a)&&(c.log("unplugging "+a,"debug",f),c.Lang.isFunction(b[a].purge)&&b[a].purge(),c.Lang.isFunction(b[a].detach)&&b[a].detach(),c.Lang.isFunction(b[a].remove)&&b[a].remove(),delete b[a])}});c.SEARCHASSIST.SaConfigUIPlugin=m},"1.0.0",{requires:["plugin","base-pluginhost"]});
YUI.add("search-assist-core",function(c,f){var m="core",m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"Sa-Core",ATTRS:{}});c.SEARCHASSIST.CORE=c.extend(m,c.SEARCHASSIST,{coreInit:function(){this.initCache();this._totalHitsToSuggestServer=this._totalHitsToCache=0;this.get("_externalDS")&&this.initExternalDS()},initializer:function(a){c.log("instantiating CORE","debug",f);this.get("quietMode")||this.coreInit(a)},initCache:function(){this.get("allowCache")&&(this.myCache=
new c.Cache({max:200,expires:8E5}),c.log("====Cache has been initialized====","debug",f))},flushCache:function(){this.get("allowCache")&&this.myCache&&(this.myCache.flush(),c.log("=====cache was flushed=====","debug",f))},initExternalDS:function(){var a=this.get("_externalDS"),b=a.url;this.validateSchema(a.params.schema);this._DS=new c.DataSource.Get({source:b})},validateSchema:function(a){try{if(!a)throw c.error("No schema specified");if(!a.resultListLocator)throw c.error("No resultListLocator field inside schema"+
c.JSON.stringify(a,null,"     "));if(!a.resultFields||!a.resultFields[0])return this._noFields=!0,void c.log("no resultFields found","warn");if(!a.resultFields[0].key)throw c.error('No "key" param inside schema for resultFields"'+c.JSON.stringify(a,null,"     "));this._noFields=!1;this.set("_suggArrayParam",a.resultFields[0].key)}catch(b){c.log("schema "+b,"error")}},getNormalizedData:function(a,b,c){var d,g=this.get("allowCache");return d=this.getNormalizedJson(a,b,c),g&&this.myCache.add(c,d,c),
d},handleNoFieldsInSchema:function(a){var b,e,d=this.getDefaultSuggArrParam(),g=a.results;c.log("Expecting resultListLocator to contain suggestions as raw array data with no objects inside","warn",f);this.set("_suggArrayParam",d);for(b=0;b<g.length;b+=1){if(c.Lang.isObject(g[b]))return c.error("When no resultFields are specified, the listlocator is assumed to be a pure array"),a;e={};e[d]=g[b];a.results[b]=e}return a},handleCustomData:function(a,b){var e,d,g=this.get("_externalDS"),h=a.typedData||
"",g=g.params,f=g.custom,l=g.schema;return d=c.Lang.isFunction(f.data)?f.data(h):c.clone(f.data),l=g.schema,e=this.getNormalizedData(d,l,h),b(e)},handleExternalDS:function(a,b){return this.get("_externalDS").params.custom?this.handleCustomData(a,b):this.handleJsonReqest(a,b)},getNormalizedJson:function(a,b){var e;return this.validateSchema(b),c.log("=====data from server======","info"),c.log(c.JSON.stringify(a,null,"   "),"info"),c.log("=====schema provided======","info"),c.log(c.JSON.stringify(b,
null,"    "),"info"),e=c.DataSchema.JSON.apply(b,a),this._noFields&&(e=this.handleNoFieldsInSchema(e)),c.log("=====normalized json data======","info"),c.log(c.JSON.stringify(e,null,"    "),"info"),e},handleJsonReqest:function(a,b){var e,d,g;d=this.get("_externalDS");var h=a.typedData||"",f=d.params;g=d.url;d=f.query;var l=this;this._DS.callBack={success:function(a){return e=l.getNormalizedData(a.response,f.schema,h),b(e)},failure:function(a){return c.log(a,"debug"),b(null)}};d=f.request+"&"+d+"="+
h;g+=d;c.log("=====request Url======","info");c.log(g,"info");this._DS.sendRequest({request:d,callback:this._DS.callBack})},createGossipParams:function(a){var b,e,d=this.get("webHistory"),g=this.get("smw"),h=this.get("ultEnabled"),f=this.get("maxSuggests");e=this.get("pubid");var l={},m=this._originalQuery||"";0!==e&&(l.pubid=e);e=this.getCursorPosOnSearchBox();c.Lang.isNumber(e)&&e<a.length&&(l.ipos=e);d&&d.crumb&&0<d.maxSuggestions&&(l.f=1,l[".crumb"]=d.crumb);g&&g.crumb&&0<g.maxSuggestions&&(l[".crumb"]=
g.crumb);var n,p;e={};var g=d=null,q=this.get("geo");e=(q&&(n=q.lat,p=q.lon,g=q.woeid,null!==n&&null!==p&&(d=p+","+n,e.latlon=d),null!==g&&(e.geoid=g)),e);return e.latlon&&(l.ll=e.latlon),(e.geoid||0===e.geoid)&&(l.geoid=e.geoid),l.output="sd1",l.command=encodeURIComponent(a),l.pq=encodeURIComponent(m),l.l=1,l.bm=3,l.appid=this.get("appId"),l.t_stmp=(new Date).getTime(),l.nresults=f,l.bck=this.get("sendBCookie")?this.get("bcookie"):null,h&&(b=this.get("ult"),l.csrcpvid=encodeURIComponent(b.csrcpvid),
l.vtestid=encodeURIComponent(b.vtestid),l.mtestid=encodeURIComponent(b.mtestid),l.spaceId=b.spaceId),c.mix(l,this.get("gossipParams"),!0),c.log(l,"debug"),l},handleDefaultDS:function(a,b){function e(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b+"="+a[b]);return c.join("&")}function d(a){return c.log("jsonPSuccess for query:"+k,"debug",f),c.log(a,"debug"),q&&l.myCache.add(k,a),b(a)}function g(a){return c.log(a,"debug"),b(null)}var h=this.get("baseUrl"),k=a.typedData||"",l=this,m,n,p=this.createGossipParams(k),
q=this.get("allowCache"),s=function(a){c.jsonp(a,{on:{success:d,failure:g}})};a.ylcForAutoComplete&&(h+=a.ylcForAutoComplete);(m=window.YAHOO&&window.YAHOO.CryptoOb?window.YAHOO.CryptoOb:null)?((n=p.command)&&delete p.command,p.pq&&delete p.pq,h+="?"+e(p)+"&callback={callback}",m.encryptUrl(h,"command",n,function(a){s(a)})):(h+="?"+e(p)+"&callback={callback}",s(h))},fireJsonData:function(a){var b,e=this,d=this.get("allowCache"),g=this.myCache;this.now&&this.now.cancel();this.now=c.later(2,this,function(){return d&&
g&&g.retrieve(a.typedData)&&(b=g.retrieve(a.typedData),b&&b.response)?(c.log("cached response","debug",f),e._totalHitsToCache+=1,void e.fire("response-received",{jsonData:b.response})):void this.getJsonData(a,function(a){e._totalHitsToSuggestServer+=1;a?(c.log("un-cached response","debug",f),c.log("suggest data received, firing response-received event:response-received","debug",f),e.fire("response-received",{jsonData:a})):(c.log("no suggest data received, firing no-response-received event:no-response-received",
"debug",f),e.fire("no-response-received"))})})},getJsonData:function(a,b){var c=this.get("_externalDS");return""!==(a.typedData||"")||this.isTrendingEnabled()?c?this.handleExternalDS(a,b):this.handleDefaultDS(a,b):b(null)}})},"0.0.1",{requires:["search-assist"]});
YUI.add("search-assist-history-suggestions-plugin",function(c){var f;f=function(){f.superclass.constructor.apply(this,arguments)};c.mix(f,{NAME:"search-assist-history-suggestions-plugin",NS:"HistorySuggestions",ATTRS:{}});c.extend(f,c.Plugin.Base,{initializer:function(){c.log("instantiating the history Search plugin #######################","debug");this.doAfter("suggest-markup-has-been-attached-to-DOM",this._highlightHistorySuggestions)},_highlightHistorySuggestions:function(f){var a,b,e,d,g,h=this.get("host"),
k=h.get("webHistory"),l=h.get("tray").Node,u=0,n=this;b=k.bcrumb;e=k.maxSuggestions||3;0===k.maxSuggestions&&(e=0);f&&f.jsonData&&(a=f.jsonData,a.r&&(d=a.r));l&&(g=l.all("> ul li"),c.each(d,function(a,d){if(13===a.m){u+=1;var s,f,k,l=g.item(d);k=l.getAttribute("data");s=h.get("translation").HISTORY_CLEAR_TITLE||"Clear";e>=u&&(l.addClass("sa-history"),b)&&(f="http://search.yahoo.com/history?action=del&query="+k+"&_bcrumb="+b+"&sa=1&o=js",k=function(a){a.stopPropagation();document.createElement("img").src=
f;l.remove(!0);n.flushCache()},s=c.Node.create('<span class="sa-history-clear">'+s+"</span>"),s.on("click",k),!h.get("mobileAutoComplete")||"phone"!==h.get("currentDevice")&&"tablet"!==h.get("currentDevice")?l.append(s):(l.one(".ac-content").insert('<td width="45" class="mb-ac-clear-btn-wrapper"></td>',"after"),l.one(".mb-ac-clear-btn-wrapper").append(s)))}}))}});c.HistorySuggestionsPlugin=f},"1.0.0",{requires:["plugin","base-pluginhost","io-base"]});
YUI.add("search-assist-linktrack",function(c,f){var m="linktrack",m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"LINKTRACK",ATTRS:{}});c.SEARCHASSIST.LINKTRACK=c.extend(m,c.SEARCHASSIST,{initializer:function(){(this.ULT=c.namespace("SA").ULT)&&(this._gprid="",c.log("Instantiating ULT for link tracking","debug",f))},_getGprid:function(){return this._gprid||""},_setGprid:function(a){return this._gprid=a||"",this._gprid},_generateLocalTimestamp:function(){var a=Math.round((new Date).getTime()/
1E3);return 9<a.toString().length?a:null},createi13nObj:function(a){return c.config.i13n?c.mix(c.config.i13n,{spaceid:a}):c.config.i13n={spaceid:a},c.config.i13n},getUltObj:function(a,b){var e=this._generateLocalTimestamp(),d={};return b=b||{},this.get("ult"),b&&c.mix(d,b),d.t_stmp=e,d.query=a.query,d.qstrl=a.qstrl,d.pqstr=a.pqstr,d.pqstrl=a.pqstrl,d.pos=a.pos,d.n_sugg=a.n_sugg,d.gprid=this._getGprid(),d.origin=c.config.win.location.hostname,a.sec&&(d.sec=a.sec),a.slk&&(d.slk=a.slk),a.uqstr&&(d.uqstr=
a.uqstr),a.uqstrl&&(d.uqstrl=a.uqstrl),d},instrumentFormSubmit:function(a){var b,c,d,g,h={},f={};this.ULT&&(b=this.get("ultEnabled"),c=this.get("ult"),d=c.spaceId,b&&d&&(g=this.get("extraUltParams")||{},f=this.getUltObj(a,g),h=this.setYlcOnAction(f,d),this.setHiddenFormItems(a,g)),this.fire("event-search-form-instrumented",h))},setHiddenFormItems:function(a){var b,e,d=this.get("searchForm");this.get("ult");a=a.fr2;e=this;c.each({fr2:a},function(a,f){if("fr2"===f)a||(a="sb-top"),b=e.get("appId"),b=
b.substr(0,b.indexOf(".yahoo.com")),a+="-"+b;else if(!a)return;var k=d.get(f);k||(k=c.Node.create('<input type="hidden" name="'+f+'">'),d.prepend(k));k.set("value",a)})},setYlcOnAction:function(a,b){var e,d=this.get("searchForm"),g=d.getAttribute("action");return this.ULT.instrument?(c.log(a,"debug"),e=this.getInstrumentedUrl(g,a),d.setAttribute("action",e),c.log("Firing:event-search-form-instrumented","debug"),{spaceId:b,ultParams:a,instrumentedSubmitUrl:e}):void 0},getInstrumentedUrl:function(a,
b){var c,d=this.get("ult").spaceId,g;if(window.YAHOO&&window.YAHOO.CryptoOb&&window.YAHOO.CryptoOb)for(g=["query","qstrl","pqstr","pqstrl"],c=0;c<g.length;c++)b[g[c]]&&delete b[g[c]];return d?(this.createi13nObj(d),this.ULT.instrument?this.ULT.instrument(a,b):null):null},sendBeacon:function(a,b){b?document.createElement("img").src=this.ULT.instrument(b,a):this.ULT.beacon(a)},logAutoCompletion:function(a,b,c){var d=this.get("ult").spaceId;a={actn:"clk",qstrl:b.length,query:b&&encodeURIComponent(b)||
"",pos:c,pqstr:encodeURIComponent(a),pqstrl:a.length,uqstr:b.substr(a.length),uqstrl:b.substr(a.length).length,gprid:this._gprid,n_sugg:this.get("tray").len,sec:"search",slk:"qryupdate",_S:d};this.sendBeacon(a,this.ULT.DEFAULT_BEACON_URL)}})},"0.0.1",{requires:["search-assist","search-assist-ult"]});
YUI.add("search-assist-mobile",function(c,f){var m="mobile",m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"Sa-Mobile",ATTRS:{}});c.SEARCHASSIST.MOBILE=c.extend(m,c.SEARCHASSIST,{mobileInit:function(){this.publishMobileEvts()},initializer:function(a){c.log("instantiating Mobile related","debug",f);this.get("quietMode")||this.mobileInit(a)},publishMobileEvts:function(){var a=this,b=this,e=this,d=this,g=b.get("searchForm"),h=b.get("searchBox"),k=this.get("saContainer"),l=
b.get("mobileExpandMode"),m=b.get("currentDevice"),n=this._allSubscr;this._touchmoved=!1;c.log("publishing Mobile events","debug",f);h&&("phone"===m||"tablet"===m)&&(this._mkeyUp=!1,this._mkeyDown=!1,h.getDOMNode(!0).addEventListener("input",function(){a._mkeyUp||a._mkeyDown?(a._mkeyUp=!1,a._mkeyDown=!1):a.fireInTheHole()},!0),n._mobileNativeUp=h.on("keyup",function(){a._mkeyUp=!0}),n._mobileNativeDown=h.on("keydown",function(){a._mkeyDown=!0}),this.pullSbxToTopOnFocus(),this.get("mobileAutoComplete")&&
k.addClass("mb-ac-wrapper"),n._clientSrchNodeOntouchEnd=h.on("click",function(a){b.get("mobileExpandMode")&&(a.stopPropagation(),a.preventDefault());d.handleEventOnSearchBox(a,"touchend")}),l||(c.delegate(["touchstart","click"],function(){a._clickOnSuggItem=!0},b.get("saContainer"),"li"),c.delegate("touchend",function(){a._clickOnSuggItem=!1},b.get("saContainer"),"li"),n._blurOnMobileNoExpand=h.on("blur",function(){return a._clickOnSuggItem?void(a._clickOnSuggItem=!1):!0===e._noRefresh?void(e._noRefresh=
!1):void e.removeSuggestionsMarkup()})));g&&l&&("phone"===m||"tablet"===m)&&(n._traySrchBoxOnFocus=b.get("searchBox").on("click",function(){b.get("searchBoxContainer").hasClass("bringtofront")||b.get("searchBoxContainer").addClass("bringtofront")}));("phone"===m||"tablet"===m)&&(c.Event.defineOutside("touchend"),n._traySrchFormOntouchEndOutside=b.get("searchForm").on("touchendoutside",function(){l&&d.removeMobileExpand();a.removeSuggestionsMarkup()}));"phone"!==m&&"tablet"!==m||(c.delegate("touchend",
function(c){b.get("searchBox").focus();a.removeHighlightClasses(c)},b.get("saContainer"),"li"),c.delegate("mouseover",function(){b.get("searchBox").focus()},b.get("saContainer"),"li"),c.delegate("click",function(b){a.removeHighlightClasses(b)},b.get("saContainer"),"li"),c.delegate(["click","touchend"],function(){b.get("searchBox").focus()},b.get("searchBoxContainer"),"*"),this._touchmoved=!1,c.delegate(["touchend","touchmove","click"],function(b){a.handleMobileEventsOnListItems(b)},b.get("saContainer"),
"li"))},handleMobileEventsOnListItems:function(a){return"touchmove"===a.type?void(this._touchmoved=!0):!0===this._touchmoved?void(this._touchmoved=!1):!this.get("mobileAutoComplete")||"mb_ac"!==a.target.get("className")&&"ac-btn"!==a.target.get("className")?(this.handleEventOnSuggestItem(a),this.onFormSubmission(a),void this.removeHighlightClasses(a)):(a.stopPropagation(),a.preventDefault(),this.handleEventOnSuggestItem(a,"autoComplete"),void this.get("searchBox").focus())},addAutoCompleteBtn:function(a){var b=
a.getHTML();a.setHTML('<table class="sa-ac-table" width="100%" cellspacing="0" cellpadding="0" border="0"><tr> <td class="ac-content">'+b+'</td><td width="45" class="ac-btn"><span class="mb_ac"></span></td></tr></table>')},handleMobileEventsOnSearchBox:function(a,b){var e,d=this.getQuery(),g=this,h=this.get("mobileExpandMode"),k=this.isTrendingEnabled();if(h&&!this.closeOnDone&&(this.closeOnDone=!0,c.later(500,this,function(){g.closeOnDone=g.get("searchBox").once("blur",function(a){h?c.later(100,
g,function(){g.removeMobileExpand(a)}):c.later(100,g,function(){g.removeSuggestionsMarkup()})})})),h&&this.addMobileExpand(),"touchend"===b&&(e=this.get("searchBox").get("value"),this.get("searchBox").set("value",e).focus()),"touchend"===b){if(this.isTrayOpen())return;""===d?this.isTrendingEnabled()&&this.fireInTheHole(a):this.fireInTheHole(a)}return"keyup"===b?void(""===d?k&&this.fireInTheHole(a):this.fireInTheHole(a)):"valuechange"===b||"query-emptiness"===b?(c.log("mobile:event:"+b,"debug",f),
void(k?""===this.getQuery()&&(c.log("query is empty","debug",f),this.isTrayOpen()&&this.isTrayTypeTrending()?c.log("trending tray already open","debug"):(c.log("Empty query and no tray is open so triggering tray to open","debug",f),this.fireInTheHole(a))):!this.isTrayOpen()||d&&""!==d||this.removeSuggestionsMarkup())):void 0},widenTray:function(){var a=this.isTrendingEnabled(),b=this.getTray();this.get("searchBox").focus();b&&b.Node&&this.isModeExpanded()?b.Node.addClass("widen-sa-tray"):a&&this.removeMobileExpand()},
updateSuggOnNoSugg:function(a,b){var e,d,g=this.getTray();return c.log("no suggestions available for the query autocompleted, so adding the same query as suggestionf or mobile","debug",f),d=this.highlightSuggestion(a,a),e=c.Node.create("<li>"+this.get("translation").MOBILE_SEARCH_FOR_TITLE+' "'+d+'"</li>'),e.setAttribute("pos",0),e.setAttribute("data",a),b.append(e),g.len=1,b},addMobileExpand:function(){var a,b=(this.get("currentDevice"),this.get("searchBox"));c.log("adding mobile expansion","debug");
this.get("mbxWrapperNode").addClass("mobile-expand-sbx-wrapper-style");b.addClass("widen-search-box");this.get("disablePlaceHolder")||(a=this.get("translation").MOBILE_PLACEHOLDER_TITLE,b.setAttribute("placeholder",a+" "+this.get("property")));this.renderClearButton();this.get("cancelButton")&&this.renderCancelBtn();this.renderMaskTray();(a=this.get("saContainer"))&&a.addClass("mbx-sa-tray-wrapper-style")},removeMobileExpand:function(){var a,b=this.getTray(),e=c.one(".sa-clear-btn"),d=this.get("searchBox"),
g=c.one(".mask-tray"),h=this.get("mbxWrapperNode"),k=this.get("saContainer");k&&(c.log("removing class mbx-sa-tray-wrapper-style","debug"),k.removeClass("mbx-sa-tray-wrapper-style"));h&&h.removeClass("mobile-expand-sbx-wrapper-style");c.log("removing mobile Expand","debug",f);this.get("cancelButton")&&(a=c.one(".mobile-expand-cancel-btn"),a&&(this.get("searchBox").removeClass("search-box-placeholder-for-cancel"),a.hide()),e=c.one(".sa-clear-btn-with-cancel-btn"));this._detachCloseOnDone();g&&g.hide();
d&&d.removeClass("widen-search-box");e&&e.hide();b&&b.Node&&b.Node.removeClass("widen-sa-tray");this.removeSuggestionsMarkup();this.get("disablePlaceHolder")||d.removeAttribute("placeholder")},renderMaskTray:function(){var a=c.one(".mask-tray"),b=this;a?a.show():(a=c.Node.create("<div></div>"),this.get("searchForm").append(a),a.addClass("mask-tray"),a.on(["touchstart","click"],function(a){a.stopPropagation();a.preventDefault();b.removeMobileExpand()}))},isModeExpanded:function(){return c.one(".widen-search-box")?
!0:!1},renderCancelBtn:function(){var a,b=c.one(".mobile-expand-cancel-btn"),e=this,d=function(a){c.log("removing mobile expansion ##########################","debug");a.stopPropagation();a.preventDefault();e.removeMobileExpand()};if(b)this.get("searchBox").addClass("search-box-placeholder-for-cancel"),b.show();else{try{a=this.get("translation").MOBILE_EXIT_BUTTON_TITLE,b=c.Node.create('<div class="mobile-expand-cancel-btn">'+a+"</div>")}catch(g){}b&&(this.get("mbxWrapperNode").append(b),this.get("searchBox").addClass("search-box-placeholder-for-cancel"),
b.on(["touchstart","touchend","click"],d))}},renderClearButton:function(){var a=c.one(".sa-clear-btn"),b=this.get("searchBox");this.get("cancelButton")&&(a=c.one(".sa-clear-btn-with-cancel-btn"));a?this.isTrayTrending()&&!this.getQuery()?a.hide():this.getQuery()?a.show():a.hide():(a=c.Node.create("<div></div>"),a.setHTML('<div class="crosshair-wrapper"><div id="clearSearchBox" class="crosshair-head" role="button" aria-label="clear search box"><div class="hair"></div><div class="hair"></div></div></div'),
a.addClass(this.get("cancelButton")?"sa-clear-btn-with-cancel-btn":"sa-clear-btn"),this.get("mbxWrapperNode").append(a),a.on(["touchstart","click"],function(a){a.stopPropagation();b.set("value","");this.hide()}),a.on("touchend",function(a){a.stopPropagation()}),""===this.getQuery()&&a.hide())},_detachCloseOnDone:function(){var a=this.get("searchBox");this.closeOnDone&&c.Lang.isFunction(this.closeOnDone.detach)&&(this.closeOnDone.detach(),delete this.closeOnDone,this.closeOnDone=null,a.blur(),c.log("REMOVED close on done registeration",
"debug",f))},pullSbxToTopOnFocus:function(){this.get("searchBox").on("focus",function(){c.later(0,null,function(){0>=window.pageYOffset&&window.scrollTo(0,1)})})}})},"0.0.1",{requires:["search-assist","search-assist-core","search-assist-linktrack","search-assist-navigate","intl"]});
YUI.add("search-assist-navigate",function(c,f){var m="navigate",m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"Sa-Navigate",ATTRS:{}});c.SEARCHASSIST.NAVIGATE=c.extend(m,c.SEARCHASSIST,{navInit:function(){this.publishKeyboardEvts();this._tabCount=1;this._origQuery=this.getQuery();this.timeSinceLastKey=0},initializer:function(a){c.log("instantiating NAVIGATE","debug",f);this._originalQuery=this.getQuery();this.get("quietMode")||this.navInit(a)},getOrigQuery:function(){return this._origQuery},
setOrigQuery:function(a){this._origQuery=a},minKeySatisfied:function(a){return a&&a.length>=this.get("minKey")?!0:!1},fireInTheHole:function(a,b){var e=this.getQuery(),d={},g=null;return this.get("spellCheck")&&""===e&&this.clearSpellCheck(),this.getOrigQuery(),b&&this.get("logAutoComplete")&&this.get("ultEnabled")&&!this.get("_externalDS")&&this.ULT&&(g=this.getYlcforAutoCompleteLogging(b)),0<this.get("minKey")&&!this.minKeySatisfied(e)?void this.removeSuggestionsMarkup():(this.setRenderedTrayType(""===
e&&this.isTrendingEnabled()?"trending":"normal"),this.setOrigQuery(e),c.log('firing some-activity-in-the-searchbox event: fired-typedData:"'+e+'"',"debug"),d={typedData:e,evtFacade:a},g&&(d.ylcForAutoComplete=g),void this.fire("some-activity-in-the-searchbox",d))},getYlcforAutoCompleteLogging:function(a){var b={},e=this.get("tray"),d={},g=this.get("extraUltParams")||{};return("tab"===a.actn||"arrow"===a.actn)&&(b.actn="keybrd"),"mb_ac"===a.actn&&(b.actn="mobile"),b.pos=a.pos,b.slk="qryupdate",b.sec=
"search",b.query=a.value&&encodeURIComponent(a.value)||"",b.qstrl=b.query.length,b.pqstr=a.query&&encodeURIComponent(a.query)||"",b.pqstrl=b.pqstr.length,b.uqstr=b.query&&encodeURIComponent(b.query.substr(b.pqstrl))||"",b.uqstrl=b.uqstr.length,e&&e.len&&(b.n_sugg=e.len),b.fr2="sa-gp",d=this.getUltObj(b,g),c.log("logging autocomplete","debug",f),this.getInstrumentedUrl("",d)},_defEvtFireInTheHole:function(a){var b={};c.log("received some-activity-in-the-searchbox event","debug",f);a&&(a.evtFacade&&
(this.evtFacade=a.evtFacade),c.log('received typedData:"'+a.typedData+'"',"debug",f),a.evtFacade?(c.log("received flame.evtFacade","debug",f),9!==a.evtFacade.charCode&&(this._tabCount=1)):c.log("missed passing eventFacade in firedinthehole event","debug",f),b.ylcForAutoComplete=a.ylcForAutoComplete||null,b.typedData=a.typedData,b.typedData?this.fireJsonData(b):!0===this.isTrendingEnabled()?(c.log("showing trending search","debug",f),this.fireJsonData(b)):(this.removeSuggestionsMarkup(),c.log("trending search supressed",
"debug",f)))},okTofollowTabIndex:function(){return c.log("_tabCount:"+this._tabCount,"debug",f),1===this._tabCount?(this.update_tabCount(),this.isTrayOpen(),!1):(this.update_tabCount(),!0)},update_tabCount:function(){this._tabCount=(this._tabCount+1)%2},getAutoCompleteValue:function(){var a=c.one(".sa-tray-list-container li");return a?decodeURIComponent(a.getAttribute("data")):null},okToAutoComplete:function(){return this.isAnySuggestionSelected()?!1:!0},handleTab:function(a){var b,e;b=this.get("searchBox");
var d=this.getQuery(),g=this.getTray();if(this.isTrendingEnabled()||d){if(!d||this.okTofollowTabIndex())return void this.removeSuggestionsMarkup();if(a.preventDefault(),b&&g&&g.Node){if(!this.okToAutoComplete())return void this.fireInTheHole(a);(b=this.getAutoCompleteValue())?(this.setSearchBoxVal(b),e={pos:1,value:b,query:d,actn:"tab"},this.fireInTheHole(a,e)):(c.log("tray exists but did not get any autocomplete suggestions","warn"),this.closeTray())}else this.fireInTheHole(a),this.resetTabTrack()}},
getCursorPos:function(a){var b,e;return a?a.selectionStart?a.selectionStart:c.config.doc.selection&&c.config.doc.selection.createRange()?(b=c.config.doc,b.activeElement.focus(),e=b.selection.createRange(),e.moveStart("character",-b.activeElement.value.length),e.text.length):0:null},getCursorPosOnSearchBox:function(){var a=this.get("searchBox").getDOMNode(),a=this.getCursorPos(a);return null===a?(c.log("unable to get cursor position","warn",f),null):(c.log("caretPos:"+a,"debug"),a)},isCursorAttheEnd:function(){var a=
this.getQuery().length,b=this.getCursorPosOnSearchBox();return c.log("len:"+a,"debug",f),c.log("cursorPos:"+b,"debug",f),a===b?!0:!1},handleArrowRight:function(a){var b,e,d=this.get("searchBox"),g=this.getQuery();b=this.getTray();if(d&&b&&b.Node)if(this.okToAutoComplete()&&this.isCursorAttheEnd())(b=this.getAutoCompleteValue())&&g!==b?(this._noRefresh=!0,d.blur().set("value",b).focus(),e={pos:1,value:b,query:g,actn:"arrow"},this.fireInTheHole(a,e)):c.log("tray exists but did not get any autocomplete suggestions",
"warn");else if(this.isCursorAttheEnd())return void this.fireInTheHole(a)},handleEsc:function(){c.log("closing tray on esc press","debug");this.removeSuggestionsMarkup();this.get("searchBox").blur()},resetTabTrack:function(){this._tabCount=1},isAnySuggestionSelected:function(){var a=c.one(".sa-tray-list-container .list-item-selected");return c.log("selected suggestion node:"+a,"debug",f),a},handleArrowUp:function(a){var b,e,d,g;d=(this.get("searchBox"),0);var h=[];if(c.log("ARROW UP KEY ***************",
"debug",f),this.resetTabTrack(),this._native)return void this.fireInTheHole();if(e=c.one(".sa-tray-list-container"),!e)return void this.fireInTheHole(a);if(d=e.all("> li"))if(d.each(function(a,b){h[b]=a}),a=h.length,d=this.isAnySuggestionSelected()||c.one(".sa-tray-list-container .list-item-hover"))for(c.log("selectedSuggestion:"+d.get("text"),"debug"),d=0,b=this.getOrigQuery(),d=0;a>d;d+=1){if(h[d].hasClass("list-item-selected")||h[d].hasClass("list-item-hover")){if(h[d].removeClass("list-item-selected"),
h[d].removeClass("list-item-hover"),0===d){this.handleNativeInputMethod(b);break}d=(d-1)%a;b=h[d].getAttribute("data");g=h[d].getAttribute("pos");this.handleNativeInputMethod(b,h[d]);this.fireCurrentSuggestionSelected({suggestion:b,pos:g});break}}else c.log("no suggestion selected :(","debug",f),d=a-1,h[d]&&(b=h[d].getAttribute("data"),g=h[d].getAttribute("pos"),this.fireCurrentSuggestionSelected({suggestion:b,pos:g}),this.handleNativeInputMethod(b,h[d]))},fireCurrentSuggestionSelected:function(a){this.fire("search-assist-suggestion-selected",
a)},handleArrowDown:function(a){var b,e,d,g;d=(this.get("searchBox"),0);var h=[];if(c.log("ARROW DOWN KEY ***************","debug",f),this.resetTabTrack(),this._native)return void this.fireInTheHole();if(e=c.one(".sa-tray-list-container"),!e)return void this.fireInTheHole(a);if(d=e.all("> li"))if(d.each(function(a,b){h[b]=a}),a=h.length,this.isAnySuggestionSelected()||c.one(".sa-tray-list-container .list-item-hover"))for(d=0,b=this.getOrigQuery(),d=0;a>d;d+=1){if(h[d].hasClass("list-item-selected")||
h[d].hasClass("list-item-hover")){if(h[d].removeClass("list-item-selected"),h[d].removeClass("list-item-hover"),d===a-1){this.handleNativeInputMethod(b);break}d=(d+1)%a;b=h[d].getAttribute("data");g=h[d].getAttribute("pos");this.fireCurrentSuggestionSelected({suggestion:b,pos:g});this.handleNativeInputMethod(b,h[d]);break}}else c.log("no suggestion selected :( ","debug",f),h[0]&&(b=h[0].getAttribute("data"),g=h[0].getAttribute("pos"),this.fireCurrentSuggestionSelected({suggestion:b,pos:g}),this.handleNativeInputMethod(b,
h[0]))},handleNativeInputMethod:function(a,b){var e=this.get("searchBox"),d=e.get("value");return""===d||this.get("allIe")||this.get("gecko")||this._c===this._d&&this._c===d||void 0===this._c||!this._native?(this._noRefresh=!0,e.blur().set("value",decodeURIComponent(a)).focus(),void(b&&b.addClass("list-item-selected"))):(c.log("native tray detected, updating tray","debug"),void this.fireInTheHole())},handleAnyKeySearch:function(a){var b,e,d,g,f,k=c.config.win,l=c.config.doc,m=this,n=this,p=function(c){(d=
c.keyCode,f=c.target||c.srcElement,g||(g=m.get("searchBox").getDOMNode()),"EMBED"===f.tagName||"OBJECT"===f.tagName||"INPUT"===f.tagName||"TEXTAREA"===f.tagName||c.altKey||c.metaKey||c.ctrlKey||!(32>d||40<d)||9===d||13===d||16===d||27===d)||n.get("backspaceBehaviorNative")&&8===d||((b=g.value.length)&&(8===d?(c.preventDefault(),g.value=g.value.substr(0,g.value.length-1)):a&&(g.value+=" ",b+=1),n.get("replaceQueryOnFocus")&&(g.value=""),g.setSelectionRange?g.setSelectionRange(b,b):g.createTextRange&&
(e=g.createTextRange(),e.moveStart("character",b),e.select())),g.focus())};k.addEventListener?(k.removeEventListener("keydown",this._fnCheckFocusPtr),this._fnCheckFocusPtr=p,k.addEventListener("keydown",p,!1),c.log("################### w.addEventListener","debug")):k.attachEvent&&(this.ieAnyKeyDocumentEvt&&l.detachEvent("onkeydown",this._fnCheckFocusPtr),this._fnCheckFocusPtr=p,this.ieAnyKeyDocumentEvt=l.attachEvent("onkeydown",p),c.log("################### d.attachEvent","debug"))},getKeyDownState:function(){return this.keyDown},
stopMonitoringUserIdleNess:function(){var a=this._allSubscr;a._timeSinceLastkeyStroke&&a._timeSinceLastkeyStroke.cancel()},monitorUserIdleNess:function(){var a=this._allSubscr,b=this;this.noActivityForLong=!1;a._timeSinceLastkeyStroke&&(a._timeSinceLastkeyStroke.cancel(),this.timeSinceLastKey=0);a._timeSinceLastkeyStroke=c.later(2E3,this,function(){b.timeSinceLastKey+=2E3;3E4<b.timeSinceLastKey&&(b.noActivityForLong=!0,a._timeSinceLastkeyStroke.cancel())},[],!0)},publishKeyboardEvts:function(){c.log("publishing default handler function for the event when there is some activity in search box",
"debug",f);this.publish("some-activity-in-the-searchbox",{defaultFn:c.bind("_defEvtFireInTheHole",this)});var a=this.get("searchBox"),b=this,e=this,d=this._allSubscr,g=this.get("noSpaceOnFocus");this.keyDown=!1;d._navigateHtmlOnKeyDown=c.one("html").on("keydown",function(a){8!==a.charCode&&(b.keyDown=!0)});d._navigateHtmlOnKeyUp=c.one("html").on("keyup",function(){b.keyDown=!1});!0===this.get("anyKeySearch")&&b.handleAnyKeySearch(g?!1:!0);a?(d._navigateSrchNodeOnKeyDown=a.on("keydown",function(a){c.log("escape on keydown",
"debug");27===a.charCode&&b.handleEsc(a);9===a.charCode&&b.handleTab(a);38===a.charCode&&a.preventDefault()}),c.later(200,this,function(){d._navigateSrchNodeOnFocus=a.on("focus",function(){""===b.getQuery()&&this.fire("query-emptiness")})}),d._navigateSrchNodeOnEmptyQuery=a.on("query-emptiness",function(a){e.handleEventOnSearchBox(a,"query-emptiness")}),d._navigateSrchNodeOnKeyUp=a.on("keyup",function(a){b.handleKeyEvent(a,"keyup")})):c.log("invalid searchNode, no keyboard or mouse or touch events registered",
"error",f)},handleKeyEvent:function(a,b){this.timeSinceLastKey=0;40===a.charCode?this.handleArrowDown(a):38===a.charCode?this.handleArrowUp(a):39===a.charCode?this.handleArrowRight(a):37===a.charCode?c.log("arrow left shouldnt do anything","info"):27===a.charCode?c.log("Esc key on keyup","debug"):8===a.charCode?""!==this.getQuery()?(c.log("backspace was pressed, query is empty - firing suggest","debug",f),this.fireInTheHole(a)):this.isTrayTrending()&&!this.isTrayOpen()&&(c.log("backspace was pressed, tray not open, query is valid - firing suggest",
"debug",f),this.fireInTheHole(a)):13===a.charCode?(!0===this._native&&(this._native=!1,this.handleEventOnSearchBox(a,b)),c.log("return key","debug")):18===a.charCode||16===a.charCode?c.log("special key pressed","debug",f):(c.log("searchnode on keyup","debug",f),this.handleEventOnSearchBox(a,b))}})},"0.0.1",{requires:["search-assist"]});
YUI.add("search-assist-smw-suggestions-plugin",function(c){var f;f=function(){f.superclass.constructor.apply(this,arguments)};c.mix(f,{NAME:"search-assist-history-suggestions-plugin",NS:"SmwSuggestions",ATTRS:{}});c.extend(f,c.Plugin.Base,{initializer:function(){c.log("instantiating the SMW plugin #######################","debug");this.doAfter("suggest-markup-has-been-attached-to-DOM",this._highlightSmwSuggestions)},_highlightSmwSuggestions:function(f){var a,b,e,d,g,h=this.get("host"),k=h.get("tray").Node,
l=h.get("smw"),u=h.get("translation").SMW_PRIVATE_LABEL_TITLE||"Private result",n=0;f&&f.jsonData&&(a=f.jsonData,a.r&&(e=a.r));d=l.maxSuggestions||3;0===l.maxSuggestions&&(d=0);k&&(g=k.all("> ul li"),c.each(e,function(a,e){if(31===a.m){n+=1;var s=g.item(e);d>=n&&(s.setAttribute("type","smw"),s.addClass("sa-smw"),b=c.Node.create('<span class="sa-smw-private-label">'+u+"</span>"),!h.get("mobileAutoComplete")||"phone"!==h.get("currentDevice")&&"tablet"!==h.get("currentDevice")?s.append(b):(s.one(".ac-content").insert('<td width="80" class="mb-ac-clear-btn-wrapper"></td>',
"after"),s.one(".mb-ac-clear-btn-wrapper").append(b)))}}))}});c.namespace("SEARCHASSIST").SmwSuggestionsPlugin=f},"1.0.0",{requires:["plugin","base-pluginhost","io-base"]});
YUI.add("search-assist-tray",function(c,f){var m="tray",m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"Sa-Tray",ATTRS:{tray:{},cloud:{}}});c.SEARCHASSIST.TRAY=c.extend(m,c.SEARCHASSIST,{trayInit:function(){this.publishTrayEvts();this.set("tray",{});this._firstSuggestion=this._curPos=this._curSuggestion=""},initializer:function(a){c.log("instantiating TRAY","debug",f);this.get("quietMode")||this.trayInit(a);this.get("configPanel")&&this.plug(c.SEARCHASSIST.SaConfigUIPlugin);
this.get("ariaPlug")&&this.plug(c.SEARCHASSIST.AriaPlugin);this._sbxPadLeftInt=this.getSearchBoxPadding("left")||0;this._sbxPadRightInt=this.getSearchBoxPadding("right")||0;this._isWidthComputed=this._offsetWidth=this._queryWidth=0;this._subAssistReady=!1},publishTrayEvts:function(){var a=this,b=this.get("searchForm"),e=this.get("currentDevice"),d=this._allSubscr;c.log("publishing Tray events","debug",f);this.publish("response-received",{defaultFn:c.bind("_defEvtRespRecvdFn",this)});this.publish("suggest-markup-has-been-attached-to-DOM",
{defaultFn:c.bind("_defEvtSuggestMarkupRendered",this)});this.publish("no-response-received",{defaultFn:c.bind("_defEvtNoRespRecvdFn",this)});this.get("autoAlign")&&this.alignTrayRegisteration();d._traySuggestionSelect=this.on("search-assist-suggestion-selected",function(b){a._curSuggestion=b.suggestion;a._curPos=parseInt(b.pos,10)});b&&(d._traySrchFormOnSubmit=b.on("submit",function(b){a.onFormSubmission(b)}),d._traySrchFormWrapperOnClickOutside=this.get("saFormWrapper").on("clickoutside",function(){c.log("clickoutside captured on ",
"debug",f);a.removeSuggestionsMarkup();a.fire("search-assist-tray-click-outside")}));"desktop"===e&&(c.delegate("mouseover",function(){a.removeAllListHighlights();this.addClass("list-item-hover")},this.get("saContainer"),"li"),c.delegate("mouseout",function(b){a.removeHighlightClasses(b)},this.get("saContainer"),"li"),c.delegate(["click"],function(b){a.handleEventOnSuggestItem(b);a.onFormSubmission(b);a.removeHighlightClasses(b)},this.get("saContainer"),"li"))},getTray:function(){return this.get("tray")},
isTrayEmpty:function(){var a=c.one(".sa-tray-list-container li");return a?(c.log("trays first list element:"+a,"debug"),!1):!0},getSuggestData:function(a){return decodeURIComponent(a.currentTarget.getAttribute("data"))},getSuggestPosition:function(a){var b;return b="B"===a.target.get("nodeName").toUpperCase()?a.target.get("parentNode").getAttribute("pos"):a.currentTarget.getAttribute("pos"),parseInt(b,10)},removeAllListHighlights:function(){c.all(".sa-tray-list-container .list-item-hover").removeClass("list-item-hover");
c.all(".sa-tray-list-container .list-item-selected").removeClass("list-item-selected")},restoreFormAction:function(){var a,b=this.get("searchForm");a=this.get("action");b.setAttribute("action",a)},customizeFormAction:function(){var a,b,e;this.restoreFormAction();a=this.get("searchForm");b=this.get("action");this.get("ylt")?e=b.replace(this.get("ylt"),this.get("yltCustom")):(e=";"===b[b.length-1]?b+this.get("yltCustom"):b+";"+this.get("yltCustom"),c.log("no default ylt token found on form action to replace it with customYlt",
"warn"));a.setAttribute("action",e)},onFormSubmission:function(a){var b,e,d,g=this,h={},k=g.get("tray"),l=this,m=0,n=this.get("mobileExpandMode");a.preventDefault();this.get("ultEnabled")&&!this.get("_externalDS")&&this.ULT&&this.get("ult")&&this.get("ult").spaceId&&(b={pqstr:"",n_sugg:0,pos:0,query:"",pqstrl:"",qstrl:""},k&&k.len&&(m=k.len),d=this.getOrigQuery()||"",b.pqstr=d&&encodeURIComponent(d)||"",b.pqstrl=d.length,b.n_sugg=m,"click"===a.type||"touchend"===a.type||"gesturemoveend"===a.type?
(this.get("yltCustom")&&this.customizeFormAction(),"trending"===k.Node.getAttribute("type")&&this.isTrendingTitleEnabled()&&this.get("searchForm").one('input[name="fr"]').set("value","sfp-tts-s"),b.fr2="sa-gp",b.pos=g.getSuggestPosition(a),"number"!=typeof b.pos&&(b.pos=0),e=g.getSuggestData(a)):e=this.getQuery(),"submit"===a.type&&(e===this._curSuggestion?(this.get("yltCustom")&&this.customizeFormAction(),b.fr2="sa-gp",b.pos=this._curPos,"number"!=typeof b.pos&&(c.log("ULT:error:position of click/touch of suggestion undefined",
"error",f),b.pos="")):(b.pqstr="",b.pqstrl="")),b.query=e&&encodeURIComponent(e)||"",b.qstrl=b.query.length,this.instrumentFormSubmit(b));k&&k.Node&&k.Node.addClass("trans-hide");c.later(500,this,function(){c.log("time for suggest markup to be removed look for : TIME_BEFORE_SUGGEST_MARKUP_IS_REMOVED","debug",f);n&&(c.log("inside Form SUbmission and now removing mobile expand","debug",f),l.removeMobileExpand());g.removeSuggestionsMarkup()});a.currentTarget&&(h=a.currentTarget);c.log("firing event:search-assist-form-submit",
"debug",f);this.fire("search-assist-form-submit",{suggestionNode:h});this._originalQuery=""},handleEventOnSuggestItem:function(a,b){var c,d,g,f,k,l=this.get("searchBox");return c=this.getSuggestData(a),d=c.toString(),k=this.getSuggestPosition(a),f=this.getQuery(),this.setSearchBoxVal(c),b?(c+=" ",this._noRefresh=!0,l.blur().set("value",c).focus(),g={pos:k,value:c,query:f,actn:"mb_ac"},this.fireInTheHole(a,g),void this.logAutoCompletion(f,d,k)):void 0},resizeTray:function(){var a=this.get("searchBox"),
b=this.get("searchBoxContainer"),e=a.get("clientWidth"),d=a.get("clientHeight"),g=a.getXY(),f=g[1]+d,k=10;this.resizeSa&&this.resizeSa.cancel();this.resizeSa=c.later(0,this,function(){this.isWidthComputed=!1;g=a.getXY();e=a.get("clientWidth");g===this.searchBoxPos&&e===this.searchBoxWidth||(this.searchBoxPos=g,this.searchBoxWidth=e,f=g[1]+d,k=10,g[1]=f+k,c.log("searchBoxWidth:"+e,"debug"),c.log("searchBoxHeight:"+d,"debug"),c.log(g,"debug"),b.setStyles({width:e+"px"}),b.setXY(g))})},alignTrayDeregisteration:function(){var a=
this._allSubscr,b=this.get("searchBoxContainer");a&&a._trayAutoAlignOnResize&&a._trayAutoAlignOnResize.detach();b.setStyles({position:"",width:"","margin-top":"",left:"",top:""})},alignTrayRegisteration:function(){var a=this._allSubscr,b=this.get("searchBox"),e=this.get("searchBoxContainer"),d=b.get("clientWidth"),g=b.get("clientHeight"),b=b.getXY();b[1]=b[1]+g+10;c.log("searchBoxWidth:"+d,"debug",f);c.log("searchBoxHeight:"+g,"debug",f);c.log(b,"debug",f);e.setStyles({position:"absolute",width:d+
"px","margin-top":"1px"});e.setXY(b);a._trayAutoAlignOnResize=c.on("resize",this.resizeTray,c.config.win,this)},removeHighlightClasses:function(a){a&&a.currentTarget&&(a.currentTarget.removeClass("list-item-hover"),a.currentTarget.removeClass("list-item-selected"))},attachTrendingTrayLabels:function(){var a,b=c.one(".trending-title"),e=c.one(".related-title");b&&b.remove();e&&e.remove();(a=c.one(".trending-label-position"))&&(b=c.Node.create("<span></span>"),b.addClass("trending-title"),b.setContent(this.get("translation").TRENDING_NOW_TITLE),
a.insertBefore(b,a));(a=c.one(".related-label-position"))&&(e=c.Node.create("<span></span>"),e.addClass("related-title"),e.setContent(this.get("translation").RELATED_TITLE),a.insertBefore(e,a))},highlightSuggestion:function(a,b,e){var d,g,f=b.split(/[\s|,]/),k="";if(this.get("disableHighlight"))return a;for(b=0;b<f.length;b+=1)d=f[b],f[b]=f[b].replace(/[;\?,:\'\/.%\*&\\\(\)\^]/g,""),f[b]&&(k=k+d+" ");return(k=this.trimEndSpace(k))?(g=e||a,k=k.split(" "),c.Highlight.all(g,k)):a},isTrayOpen:function(){var a=
this.get("tray");return a&&a.Node?(c.log("tray and tray.Node exist","debug",f),!0):(c.log("tray or tray.Node doesnt exist yet","debug",f),!1)},closeTray:function(){this.isTrayOpen()&&this.removeSuggestionsMarkup()},buildTrayNode:function(){var a=this.get("saContainer"),b=this.get("tray");return b.Node||(b.Node=c.Node.create("<div></div>"),b.Node.addClass("sa-tray"),a.append(b.Node)),b.Node},buildEmptyTray:function(){var a=c.Node.create("<ul></ul>");return a.addClass("sa-tray-list-container"),a},buildTray:function(a){c.log("building TRAY",
"debug",f);this.buildTrayNode();this.buildTrayContent(a)},buildTrayContent:function(a){var b,e=this.get("tray"),d=this.isTrayTypeTrending(),g=this.getQuery();b=this.getTrayHtml(a);this.fire("before-suggest-markup-has-been-attached-to-DOM");0<e.len?(e.Node.setHTML(b),this.fire("suggest-markup-has-been-attached-to-DOM",{trending:d,query:g,suggestionMarkup:b,firstSuggestion:this._firstSuggestion,jsonData:a})):(this.update_tabCount(),this.closeTray(),this.fire("zero-suggestions-rendered-to-DOM",{query:g}),
c.log("closed the tray, since tray.len is 0","debug",f))},buildSuggestion:function(a){return c.Node.create("<li>"+a+"</li>")},getTrayHtml:function(a){var b,e,d,g,h,k,l,m,n,p,q,s,t=0,v=this.getQuery(),C=this.isTrayTypeTrending(),x=0,r=this.getTray(),z=!1,A=!1,w=this.get("currentDevice"),D="desktop"===w&&!this.get("ieTillSeven")&&this.get("subAssist")&&a.sqpos&&c.Lang.isNumber(a.sqpos),y=this.getQuery(),B=this.get("enableTruncation")&&("tablet"===w||"phone"===w);if(b=a.r,q=this.getDefaultSuggArrParam(),
this.get("_externalDS"))try{if(!a.results)throw c.error("results has no data, check schema and server data");q=this.get("_suggArrayParam");b=a.results}catch(E){c.log("error"+E,"error"),c.log(JSON.stringify(a,null,"  "),"error")}if(e=b.length,this._offsetWidth=0,this._isWidthComputed=!1,d=this.buildEmptyTray(),r&&r.Node&&B&&r.Node.addClass("truncation"),a&&a.l&&(g=this._setGprid(a.l.gprid)),c.log("Gprid:"+g,"debug",f),r&&(r.origLen=e,r.len=0),0<e){r&&r.Node&&this.computeQueryWidthOnDOM(y,r,d);e>this.get("maxSuggests")&&
(e=this.get("maxSuggests"));for(t=0;e>t;t+=1)h=b[t][q],g=c.Escape.html(b[t][q]),0===t&&(this._firstSuggestion=g),B?(s=this.computeTruncation(g,r,d,this.get("searchBox").get("clientWidth")),k=s.truncated?this.highlightSuggestion("..."+s.text,v,h):this.highlightSuggestion(g,v,h)):k=this.highlightSuggestion(g,v,h),D&&!this.isQueryPastSearchBox()?(this._subAssistReady=!0,n=y.substr(a.sqpos),m=h.substr(a.sqpos),m=this.trimEndSpace(m),m&&(k=this.highlightSuggestion(m,n),r&&r.Node&&!r.Node.hasClass("sub-assist")&&
(r.Node.addClass("sub-assist"),r.Node.addClass("no-wrap")),r&&r.Node&&!this._isWidthComputed&&(this._isWidthComputed=!0,p=y.substr(0,a.sqpos),this._offsetWidth=this.computeListItemWidth(p,r,d,!0)-this._sbxPadLeftInt-(this._listItemPadLeftInt||0)+5))):(this._subAssistReady=!1,this.removeSubAssist(r)),k&&(l=c.Node.create("<li>"+k+"</li>"),l.setAttribute("pos",t+1),l.setAttribute("data",encodeURIComponent(h)),C&&(4!==b[t].m||z||(z=!0,l.addClass("trending-label-position")),2!==b[t].m||A||(A=!0,l.addClass("related-label-position"))),
this.get("webHistory")&&13===b[t].m&&l.setAttribute("type","history"),!this.get("mobileAutoComplete")||"tablet"!==w&&"phone"!==w||this.addAutoCompleteBtn(l),x+=1,d.append(l));return r&&(r.len=x),c.log("Printing Tray markup","debug",f),c.log(d.getHTML(),"debug",f),d}return this.get("mobileExpandMode")&&r&&0===x&&""!==v?this.updateSuggOnNoSugg(v,d):void 0},computeQueryWidthOnDOM:function(a,b,c){return this._queryWidth=this.computeListItemWidth(a,b,c,!0),this._queryWidth},isQueryPastSearchBox:function(){var a=
this._queryWidth,b=this.get("searchBox").get("clientWidth")-this._sbxPadLeftInt;return a>b-this._sbxPadRightInt?(c.log("textWidth:"+a+"greater than sbxWidth:"+b,"debug",f),!0):!1},handleSubAssistReady:function(){var a,b,c=this.get("tray");this._subAssistReady&&(b=this.get("searchBox").get("clientWidth"),a=c.Node.get("clientWidth"),this._offsetWidth+a>b&&(c.Node.removeClass("no-wrap"),this._offsetWidth=b-c.Node.get("clientWidth")),c.Node.setStyle("left",this._offsetWidth+"px"))},removeSubAssist:function(a){a&&
a.Node&&(a.Node.removeClass("sub-assist"),a.Node.removeClass("no-wrap"),a.Node.removeClass("absolute"))},getSearchBoxPadding:function(a){var b,c=this.get("searchBox");return"left"===a&&(b=c.getStyle("paddingLeft")),"right"===a&&(b=c.getStyle("paddingRight")),this.convertPxToInt(b)},convertPxToInt:function(a){var b=0;return a&&1<a.length&&(a=a.substr(0,a.length-2),b=parseInt(a,10)),b},computeTruncation:function(a,b,e,d){var f,h,k=c.Node.create('<li class="measurer"><b class="yui3-highlight">'+c.Escape.html(a)+
"</b></li>");return b.Node.addClass("measurer-absolute"),b.Node.addClass("measurer-no-wrap"),k.addClass("measurer-no-overflow"),e.append(k),b.Node.setHTML(e),k.setHTML('<li class="measurer"><b class="yui3-highlight">'+a+"</b></li>"),f=k.get("clientWidth"),d>f?(k.remove(),b.Node.removeClass("measurer-absolute"),b.Node.removeClass("measurer-no-wrap"),{text:a,truncated:!1}):(h=d>f-30?7:d>f-60?14:d>f-90?21:d>f-120?28:35,k.remove(),b.Node.removeClass("measurer-absolute"),b.Node.removeClass("measurer-no-wrap"),
{text:a.substr(h),truncated:!0})},computeListItemWidth:function(a,b,e,d){var f;a=c.Node.create('<li><b class="yui3-highlight">'+c.Escape.html(a)+"</b></li>");return b.Node.addClass("measurer-absolute"),d&&(b.Node.addClass("measurer-no-wrap"),a.addClass("measurer-no-overflow")),e.append(a),b.Node.setHTML(e),void 0===this._listItemPadLeftInt&&(this._listItemPadLeftInt=this.convertPxToInt(a.getStyle("paddingLeft"))),f=b.Node.get("clientWidth"),a.remove(),b.Node.removeClass("measurer-absolute"),d&&b.Node.removeClass("measurer-no-wrap"),
b.Node.setHTML(""),f},isTrendingTitleAttached:function(){return c.one(".trending-title")?!0:!1},isTrayTrending:function(){return!this.isTrendingEnabled()||this.getQuery()||this.isTrayEmpty()?!1:(c.log("Trending tray is open","debug",f),this.get("searchBox").focus(),!0)},setRenderedTrayType:function(a){this.trayType=a},getRenderedTrayType:function(){return this.trayType},isTrayTypeTrending:function(){return"trending"===this.getRenderedTrayType()?(c.log("tray type is Trending","debug",f),!0):(c.log("tray type is normal",
"debug",f),!1)},removeTrayHtml:function(){var a=this.get("tray");a&&a.Node&&(a.Node.remove(!0),delete a.Node,this.fire("search-assist-tray-removed"))},removeSuggestionsMarkup:function(){c.log("removing Markup for Suggestions","debug",f);this.isRenderMode("tray")&&this.removeTrayHtml();this.get("fakeBox")&&!this.get("ieTillEight")&&(this.ghost&&this.ghost.cancel(),this.resetFBox())},isRenderMode:function(a){return this.get("renderMode")===a?!0:void 0},buildSuggestionsMarkup:function(a){c.log("Building Markup for Suggestions",
"debug",f);this.isRenderMode("tray")&&this.buildTray(a)},_defEvtRespRecvdFn:function(a){var b=this.get("spellCheck");c.log("~~~~~~~~~~~number of suggest server hits"+this._totalHitsToSuggestServer,"debug",f);c.log("~~~~~~~~~~~number of cache hits"+this._totalHitsToCache,"debug",f);a&&a.jsonData?(b&&this.spellCheck(a.jsonData),this.buildSuggestionsMarkup(a.jsonData)):c.log("no data received from suggest server","debug",f)},_defEvtNoRespRecvdFn:function(){var a=this;c.later(100,this,function(){a.closeTray()});
c.log("~~~~~~~~~~~number of suggest server hits"+this._totalHitsToSuggestServer,"debug",f);c.log("~~~~~~~~~~~number of cache hits"+this._totalHitsToCache,"debug",f);c.log("no response received from suggest server:"+this.get("baseUrl"),"debug",f)},_defEvtSuggestMarkupRendered:function(a){c.log("Suggest has been attached to DOM: RENDER complete","debug",f);var b=this.get("tray"),e=this.get("branding"),d=this.get("mobileExpandMode"),g=this.isTrendingEnabled(),h=this.isTrendingTitleEnabled();return g||
""!==this.getQuery()?(this.handleSubAssistReady(),b&&b.Node&&(a.trending?(this.attachTrendingTrayLabels(b.Node),b.Node.setAttribute("type","trending"),h&&b.Node.insertBefore('<div class="trayTitle"><span class="icon trendingGray"></span><span class="title">TRENDING NOW</span></div>',b.Node.one(".sa-tray-list-container"))):b.Node.setAttribute("type","normal"),e&&b.Node.append('<div class="branding '+e.mode+' ">'+e.label+"</div>")),this.fire("search-assist-tray-showing",{mobileExpandMode:d}),void(d&&
this.widenTray())):void this.closeTray()},addNewSuggestion:function(a){var b,e=this.getTray(),d=a.markup||"",g=c.one(".sa-tray-list-container"),h=a.suggestionText||"";c.log("adding new suggestion","debug",f);this.buildTrayNode();g||(c.log("Building empty tray","debug",f),g=this.buildEmptyTray(),e.Node.setHTML(g));e&&e.Node&&g&&(c.log("tray and tray.Node and trayListContainer exist","debug",f),b=c.Node.create('<li class="spcl-sugg">'+d+"</li>"),b.setAttribute("data",encodeURIComponent(h)),a.prepend?
g.prepend(b):g.append(b))}})},"0.0.1",{requires:"search-assist-aria-plugin search-assist-config-panel-plugin search-assist-history-suggestions-plugin search-assist-smw-suggestions-plugin search-assist search-assist-core search-assist-linktrack search-assist-navigate intl".split(" ")});
YUI.add("search-assist-ult",function(c){function f(a){var b,c,f,k,l,m,n="",p=a.length,q=0;do b=a.charCodeAt(q++),c=a.charCodeAt(q++),f=a.charCodeAt(q++),k=b>>2,b=(3&b)<<4|c>>4,l=(15&c)<<2|f>>6,m=63&f,isNaN(c)?l=m=64:isNaN(f)&&(m=64),n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-".charAt(k)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-".charAt(m);
while(p>q);return n}function m(a){var b,c;b=0;for(c=a.length;c>b;b++)if(32>a.charCodeAt(b))return!0;return!1}var a=c.Lang,b=c.namespace("SA");b.ULT||(b.ULT={});c.mix(b.ULT,{SRC_SPACEID_KEY:"_S",DEFAULT_BEACON_URL:"http://geo.yahoo.com/t",beacon:function(a){a=this.instrument(this.DEFAULT_BEACON_URL,a)+"?t="+Math.random();var b=new Image;b.onload=b.onerror=function(){b=b.onload=b.onerror=null};b.src=a},instrument:function(e,d){var g,h,k=[],l=[];if(!a.isObject(d))return e;if(!d[b.ULT.SRC_SPACEID_KEY]){if(!c.config.i13n||
!c.config.i13n.spaceid)return e;d[b.ULT.SRC_SPACEID_KEY]=c.config.i13n.spaceid}return d._r=2,h=0,c.each(d,function(b,c){if(!a.isString(b))try{b=b.toString()}catch(d){return e}return 1>c.length||8<c.length||-1!==c.indexOf(" ")||m(c)||m(b)?(k=[],e):void(k[h++]=c)}),k.length?(k=k.sort(),h=0,c.each(k,function(a){var b=d[a];l[h++]=a+"\u0003"+b}),g=l.join("\u0004"),1>g.length||1024<g.length?e:(g=";_ylc="+f(g),h=e.indexOf("/*"),-1===h&&(h=e.indexOf("/?")),-1===h&&(h=e.indexOf("?")),-1===h?e+g:e.substr(0,
h)+g+e.substr(h))):e}})},"0.0.1",{requires:["event-delegate","querystring-stringify"]});
YUI.add("search-assist",function(c,f){var m=c.namespace("Client-Side-Search-Assist"),a={bcrumb:(new Date).getTime(),crumb:(new Date).getTime(),maxSuggestions:3,highlightHistory:!0},b={crumb:(new Date).getTime(),maxSuggestions:3},e={label:"Search Suggest by Yahoo",mode:"regular"},d={spaceId:null,csrcpvid:null,vtestid:null,mtestid:null},g={lat:null,lon:null,woeid:null},h={expandMode:!1,skin:"phone",disablePlaceHolder:!1},k={expandMode:!1,skin:"desktop",disablePlaceHolder:!0},l={expandMode:!1,skin:"tablet",
disablePlaceHolder:!0},u={desktop:k,phone:h,tablet:l},n={RELATED_TITLE:"Related Searches",TRENDING_NOW_TITLE:"Trending Searches",MOBILE_SEARCH_FOR_TITLE:"Search For",MOBILE_EXIT_BUTTON_TITLE:"cancel",MOBILE_END_PIECE_TITLE:"Press Enter To Search",MOBILE_PLACEHOLDER_TITLE:"Search"},p={US:!0,AR:!0,AU:!0,BR:!0,CA:!0,DE:!0,ES:!0,FR:!0,QC:!0,HK:!0,ID:!0,IN:!0,IT:!0,KR:!0,MX:!0,MY:!0,NZ:!0,PH:!0,SG:!0,TH:!0,TW:!0,UK:!0,ESPANOL:!0,MALAYSIA:!0,VN:!0,AT:!0,CH:!0,CL:!0,CO:!0,DK:!0,FI:!0,NL:!0,NO:!0,PE:!0,RU:!0,
SE:!0,VE:!0},q={"en-US":{web:0,sports:102,image:103,news:104,directory:108,video:112,audio:115,finance:596,"autos-vertical":609,"autos-related":610,"autos-also-try":611,"music-web-backfill":1002,shine:1003,omg:1004,games:1005,dictionary:1306,answers:1307,"answers-vertical":1317,"movie-vertical":1308,"movie-web-backfill":1308,"shopping-vertical":1312},"es-AR":{web:0,image:287,news:288,video:292,blog:359,answers:1307,"answers-vertical":1317},"de-AT":{web:0},"en-AU":{web:0,image:231,news:232,directory:234,
video:236,lifestyle:1101,sports:1102,tv:1103,finance:1104,movie:1105,recipe:1106,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"pt-BR":{web:0,image:244,news:245,video:249,answers:1307,"answers-vertical":1317},"en-CA":{web:0,image:396,news:397,directory:399,video:401,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"fr-CA":{web:0,image:411,news:412,directory:414,video:416,answers:1307,"answers-vertical":1317},"fr-CH":{web:0},
"it-CH":{web:0},"de-CH":{web:0},"es-CL":{web:0},"es-CO":{web:0},"de-DE":{web:0,audio:132,image:350,news:351,directory:352,local:354,video:356,mobile:362,answers:1307,"answers-vertical":1317},"da-DK":{web:0},"es-US":{web:0,image:382,news:383,directory:385,video:387,answers:1307,"answers-vertical":1317},"es-ES":{web:0,image:302,news:303,directory:304,local:306,video:308,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"se-FI":{web:0},"sv-FI":{web:0},"fi-FI":{web:0},
"fr-FR":{web:0,image:318,news:319,directory:320,local:322,video:324,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"zh-Hant-HK":{web:0,blog:122,news:134,forum:135,image:147,audio:148,directory:149,knowledge:152,video:153,"shopping-vertical":1301,dictionary:1306},"id-ID":{web:0,image:467,news:468,audio:469,directory:470,video:472,answers:1307,"answers-vertical":1317},"en-IN":{web:0,image:426,news:427,directory:429,local:431,video:433,answers:1307,"answers-vertical":1317},
"it-IT":{web:0,image:366,news:367,directory:368,local:370,video:372,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"es-MX":{web:0,image:272,news:273,video:277,mobile:283,answers:1307,"answers-vertical":1317},"en-MY":{web:0,image:453,news:454,directory:456,video:458,blog:461,answers:1307,"answers-vertical":1317},"ms-MY":{web:0,image:453,news:454,directory:456,video:458,blog:461,answers:1307,"answers-vertical":1317},"nl-NL":{web:0},"se-NO":{web:0},"nb-NO":{web:0},
"nn-NO":{web:0},"en-NZ":{web:0,image:531,news:532,video:536,lifestyle:1201,sports:1202,finance:1203,movie:1204,"movie-web-backfill":1308,recipe:1205,answers:1307,"answers-vertical":1317},"qu-PE":{web:0},"es-PE":{web:0},"en-PH":{web:0,image:482,news:483,directory:485,video:487,answers:1307,"answers-vertical":1317},"ru-RU":{web:0},"tt-RU":{web:0},"se-SE":{web:0},"su-SE":{web:0},"en-SG":{web:0,image:216,news:217,directory:219,video:221,answers:1307,"answers-vertical":1317},"th-TH":{web:0,image:497,news:498,
video:502,answers:1307,"answers-vertical":1317},"zh-Hant-TW":{web:0,image:183,news:184,audio:185,directory:186,knowledge:189,video:190,blog:193,academia:195,mobile:197,wretch:548,"shopping-srp-vertical":1301,"shopping-mall-vertical":1302,"shopping-store-vertical":1303,"auction-vertical":1304,"service-vertical":1305,"shopping-category-vertical":1322,"shopping-store-category-vertical":1323,"auction-category-vertical":1324,dictionary:1306},"cy-GB":{web:0,audio:131,image:334,news:335,directory:336,local:338,
video:340,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"en-GB":{web:0,audio:131,image:334,news:335,directory:336,local:338,video:340,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"es-VE":{web:0},"vi-VN":{web:0,image:513,news:514,video:518,blog:521,answers:1307,"answers-vertical":1317}};q["zh-HK"]=q["zh-Hant-HK"];q["zh-TW"]=q["zh-Hant-TW"];m=function(){m.superclass.constructor.apply(this,arguments)};c.mix(m,{NAME:"SearchAssist",
ATTRS:{property:{value:"web",setter:function(a){return void 0===this.getPubId(a)?"web":a}},translation:{valueFn:function(){return n},setter:function(a){return c.mix(a,n),a}},pubid:{setter:function(a){return a},valueFn:function(){var a,b=this.get("property");return a=this.getPubId(b),"undefined"!==a?a:0}},ylt:{value:null},yltCustom:{value:null},action:{valueFn:function(){if(this.get("yltCustom")){var a,b=this.get("searchForm").getAttribute("action"),c=b.split(/[;\?]+/),d=/_ylt/gi;this.set("action",
b);for(a=0;a<c.length;a+=1)d.test(c[a])&&this.set("ylt",c[a]);return b}return""}},reverseHighlight:{value:!0},market:{value:"us"},dataSrc:{setter:function(a){if(!a.url)throw c.error("No url inside dataSrc config param");return c.log("dataSrc.url: "+a.url,"debug"),this.flushCache(),a},valueFn:function(){this._newProperty=this.get("property");var a=this.intlTheUrl();return c.log("valueFn"+a,"debug"),{url:a,params:null}}},baseUrl:{getter:function(){return this.get("dataSrc").url}},_externalDS:{valueFn:function(){return this.get("dataSrc").params?
this.get("dataSrc"):!1},getter:function(){return this.get("dataSrc").params?this.get("dataSrc"):!1}},_suggArrayParam:{value:"k"},quietMode:{value:!1,setter:function(a){return c.Lang.isBoolean(a)?a:void 0}},allowCache:{value:!1,setter:function(a){return c.Lang.isBoolean(a)?a:void 0}},cancelButton:{value:!1},maxSuggests:{value:4},searchBox:{initOnly:!0,setter:function(a){var b=c.one(a);return b||c.error("Invalid Search Box id specified"+a),"off"!==b.getAttribute("autocomplete")&&b.setAttribute("autocomplete",
"off"),b.setAttribute("autocorrect","off"),b.setAttribute("autocapitalize","off"),b.setStyles({"-webkit-tap-highlight-color":"transparent"}),b}},searchForm:{valueFn:function(){return this.get("searchBox").get("form")},setter:function(a){var b=c.one(a);return b||c.error("not a valid search form node"+a),b},getter:function(){return this.get("searchBox").get("form")}},preventFormSubmit:{value:!1},hostNodeToAttach:{setter:function(a){return c.one(a)?c.one(a):null}},fakeBox:{value:!1},fakeBoxNode:{getter:function(){return c.one("#fakeBox")}},
fakeBoxHintNode:{getter:function(){return c.one("#fakeBoxHint")}},searchBoxContainer:{valueFn:function(){var a,b=c.Node.create("<div></div>");return b.generateID(),a=this.get("hostNodeToAttach"),a||(a=this.get("searchForm")),a.append(b),b.addClass("sa-sbx-container"),b}},gossipParams:{value:{},setter:function(a){return a}},saFormWrapper:{valueFn:function(){return this.get("searchForm").wrap('<div class="search-assist-form-wrapper"></div>'),c.one(".search-assist-form-wrapper")}},saContainer:{valueFn:function(){var a=
c.Node.create("<div></div>");return a.generateID(),this.get("searchBoxContainer").append(a),a.addClass("sa"),this.get("reverseHighlight")&&a.addClass("lowlight"),a}},ieTillFive:{valueFn:function(){return 0<c.UA.ie&&6>c.UA.ie?!0:!1}},ieTillSix:{valueFn:function(){return 0<c.UA.ie&&7>c.UA.ie?!0:!1}},ieTillSeven:{valueFn:function(){return 0<c.UA.ie&&8>c.UA.ie?!0:!1}},ieTillEight:{valueFn:function(){return 0<c.UA.ie&&9>c.UA.ie?!0:!1}},allIe:{valueFn:function(){return 0<c.UA.ie?!0:!1}},gecko:{valueFn:function(){return 0<
c.UA.gecko?!0:!1}},mbxWrapperNode:{initOnly:!0,setter:function(a){return c.one(a)}},appId:{valueFn:function(){return c.config.win.location.hostname||"search.yahoo.com"},setter:function(a){return a}},exitScreenButton:{value:!1},sendBCookie:{value:!0,setter:function(a){return c.Lang.isBoolean(a)?a:void 0}},bcookie:{valueFn:function(){return encodeURIComponent(c.Cookie.get("B"))||encodeURIComponent(c.Cookie.get("BX"))||null}},smw:{lazyAdd:!1,setter:function(a){return a?(this._smwPlugged||(this._smwPlugged=
!0,this.plug(c.SEARCHASSIST.SmwSuggestionsPlugin)),c.mix(a,b),a):(this._smwPlugged=!1,this.unplug(c.SEARCHASSIST.SmwSuggestionsPlugin),!1)}},spellCheck:{value:!1,setter:function(a){return c.Lang.isBoolean(a)?a:void 0}},disableHighlight:{value:!1,setter:function(a){return c.Lang.isBoolean(a)?a:void 0}},spellCheckNode:{getter:function(){return c.one("#spellCheckBox")}},webHistory:{lazyAdd:!1,setter:function(b){return b?(!this._webHistoryPlugged&&b.highlightHistory&&(this._webHistoryPlugged=!0,this.plug(c.HistorySuggestionsPlugin)),
c.mix(b,a),b):(this._webHistoryPlugged=!1,this.unplug(c.HistorySuggestionsPlugin),!1)}},branding:{setter:function(a){return a?(c.mix(a,e),a):!1}},ariaPlug:{value:!1},renderMode:{value:"tray"},enableTrending:{value:!1,setter:function(a){return this._origETVal=a,a},getter:function(){return this.checkUrlSupportForEmptyQuery()&&this._origETVal}},enableTrendingTitle:{value:null},autoAlign:{value:!1},anyKeySearch:{value:!1},backspaceBehaviorNative:{value:!1},replaceQueryOnFocus:{value:!1},noSpaceOnFocus:{value:!1},
disablePlaceHolder:{value:!1,getter:function(){return this.get("device")[this.get("currentDevice")].disablePlaceHolder}},configPanel:{value:null},skin:{getter:function(){return this.get("device")[this.get("currentDevice")].skin}},currentDevice:{valueFn:function(){return c.UA.mobile?0<c.UA.iphone?"phone":"tablet":"desktop"},setter:function(a){return"phone"!==a&&"tablet"!==a&&"desktop"!==a?(c.log("invalid device type specified"+a+".device type has to be phone tablet or desktop","error"),"desktop"):
(!0===this.get("device")[a].expandMode&&this.createMobileWrapper(),a)}},mobileExpandMode:{value:!1,getter:function(){return this.get("device")[this.get("currentDevice")].expandMode}},device:{valueFn:function(){return u},setter:function(a){return c.mix(a,u),c.mix(a.phone,h),c.mix(a.desktop,k),c.mix(a.tablet,l),a}},ultEnabled:{setter:function(a){return c.Lang.isBoolean(a)?a:void 0},valueFn:function(){return!1}},ult:{setter:function(a){return c.mix(a,d),c.Lang.isString(a.spaceId)?a:d}},enableTruncation:{value:!1},
mobileAutoComplete:{value:!1},logAutoComplete:{value:!1},minKey:{setter:function(a){return c.Lang.isNumber(a)&&0<=a?a:(c.log("minKey can take numbers ranging [0, )","error"),0)},value:0},subAssist:{value:!1},lang:{value:"en-US",setter:function(a){return a}},https:{value:!1,setter:function(a){return a}},geo:{valueFn:function(){return g},setter:function(a){return c.mix(a,g),a}},extraUltParams:{value:{},setter:function(a){return c.Lang.isObject(a)?a:(c.log("erroneous ultExtraParams provided, make sure its an object",
"error"),{})}}}});c.SEARCHASSIST=c.extend(m,c.Base,{initializer:function(a){c.log("instantiating SearchAssist","debug",f);a=a||{};c.log("cfg-Obj:","debug",f);c.log(a,"debug");this._allSubscr={};this.get("ult")&&this.set("ultEnabled",!0);this.setDeviceClass();!0===this.get("mobileExpandMode")&&this.createMobileWrapper();!0===this._isCookieSetForSAActive()?this.set("quietMode",!1):this.set("quietMode",!0);this.on("quietModeChange",this.handleQuietModeChange);this.on("autoAlignChange",this.handleAutoAlignChange);
this.on("propertyChange",this.handlePropertyChange);this.after("langChange",this.handleLangChange);this.after("webHistoryChange",this.updateDataSrcUrl);this.after("httpsChange",this.updateDataSrcUrl);this.after("ultChange",this.setUltStatus);this._origProperty=this.get("property");this._newProperty=this.get("property")},setUltStatus:function(a){a.newVal?this.set("ultEnabled",!0):this.set("ultEnabled",!1)},setDeviceClass:function(){var a=this.get("currentDevice"),b=this.get("skin"),d=c.one("html");
d&&(d.removeClass("sa-device-phone"),d.removeClass("sa-device-tablet"),d.removeClass("sa-device-desktop"),d.addClass("sa-device-"+a),d.removeClass("sa-skin-phone"),d.removeClass("sa-skin-tablet"),d.removeClass("sa-skin-desktop"),d.addClass("sa-skin-"+b))},checkUrlSupportForEmptyQuery:function(){return this._urlSupportsTrending||this.get("dataSrc")&&this.get("dataSrc").supportsEmptyQuery?!0:!1},getDefaultSuggArrParam:function(){return"k"},_isCookieSetForSAActive:function(){var a=c.config.doc.cookie.match(/(?:^|\s*;\s*)SP=(?:[^&]*&)?a=(\d)(?:&|;)?/);
return a&&"0"===a[1]?!1:!0},_detachAllSubscriptions:function(){var a,b=this._allSubscr;if(b)for(a in b)b.hasOwnProperty(a)&&(c.log("detaching subscription: "+a,"debug",f),b[a].detach())},updateDataSrcUrl:function(){var a=this.intlTheUrl();a&&this.set("dataSrc",{url:a})},getPubIdForProp:function(a,b){var d=q[b];return d&&void 0!==d[a]?d[a]:(c.log("No PubId found for lang="+b+" and property="+a,"warn",f),0)},handleLangChange:function(a){this.updateDataSrcUrl(a);a=this.getPubIdForProp(this._newProperty,
this.get("lang"));this.set("pubid",a)},handlePropertyChange:function(a){a=a.newVal;var b=this.getPubId(a);void 0!==b?(this.set("pubid",b),this.flushCache()):(b=this.getPubId(this._origProperty),c.log("no Pubid for the given property:"+a,"warn",f),c.log("defaulting to pubid for original property:"+this._origProperty,"warn",f),void 0!==b?(this.set("pubid",b),this.flushCache()):(c.log("defaulting to pubid0","warn",f),this.set("pubid",0)));this._newProperty=a;this.handleLangChange()},handleAutoAlignChange:function(a){a=
a.newVal;var b=this._allSubscr;!1===a&&(c.log("autoAlign has been set to false.. deregistering it","debug"),this.alignTrayDeregisteration());!0===a&&(c.log("autoAlign has been set to true.. reregistering it","debug"),b&&!b._autoAlignRegistered&&this.alignTrayRegisteration())},handleQuietModeChange:function(a){a=a.newVal;!1!==a||this._initDone||(this._initDone=!0,c.log("reattach all subscriptions","debug",f),this.coreInit(),this.clientInit(),this.navInit(),this.trayInit());!0===a&&(c.log("detach all subscriptions",
f),this.closeTray(),this._detachAllSubscriptions(),this._initDone=!1)},isTrendingEnabled:function(){return this.get("enableTrending")},isTrendingTitleEnabled:function(){return this.get("enableTrendingTitle")},createMobileWrapper:function(){c.one(".mobile-expand-sbx-wrapper")||(this.get("searchBox").wrap('<div class="mobile-expand-sbx-wrapper"></div'),this.set("mbxWrapperNode",".mobile-expand-sbx-wrapper"))},getPubId:function(a){var b=this.get("lang"),d=q[b];return d&&"undefined"!==d[a]?d[a]:(c.log("no valid pubid found for lang="+
b+"property="+a,"warn",f),c.log("using default pubid","warn",f),0)},intlTheUrl:function(){return this.setMarket(),this.langifySuggestUrl()},langifySuggestUrl:function(){var a,b,d=this.get("lang"),e=this.get("market"),g=this._newProperty;switch(g&&(g=g.toLowerCase()),b="http"+(!0===this.get("https")?"s":""),a=b+"://"+e+".search.yahoo.com/sugg/gossip/gossip-"+("malaysia"===e?"my":e),this._urlSupportsTrending=!1,d){case "en-US":switch(a=b+"://search.yahoo.com/sugg/",g){case "web":a+="gossip/gossip-us-ura";
this._urlSupportsTrending=!0;break;case "sports":case "image":case "news":case "directory":case "video":case "audio":case "shine":case "omg":case "games":case "finance":a+="ss/gossip-us_ss";break;case "autos-vertical":case "movie-vertical":case "shopping-vertical":case "dictionary":a+="gossip/gossip-us-vertical_ss";break;case "answers-vertical":case "answers":a+="ss/gossip-us_ss-vertical_ss";break;case "autos-related":a+="gossip/gossip-us-seaview";break;case "autos-also-try":a+="gossip/gossip-us-falcon";
break;case "music-web-backfill":a+="gossip/gossip-us-uh";break;case "movie-web-backfill":a+="gossip/gossip-us-uh_ss";break;default:a+="gossip/gossip-us-ura",this._urlSupportsTrending=!0}break;case "es-AR":case "pt-BR":case "de-DE":case "id-ID":case "en-IN":case "es-MX":case "en-MY":case "ms-MY":case "en-PH":case "en-SG":case "th-TH":case "vi-VN":"answers"!==g&&"answers-vertical"!==g||(a+="-vertical_ss");break;case "fr-CA":a=b+"://"+e+".search.yahoo.com/sugg/gossip/gossip-ca_fr";"answers"!==g&&"answers-vertical"!==
g||(a+="-vertical_ss");break;case "en-AU":case "en-CA":case "es-ES":case "fr-FR":case "it-IT":"movie-vertical"!==g&&"answers"!==g&&"answers-vertical"!==g||(a+="-vertical_ss");"movie-web-backfill"===g&&(a+="-uh_ss");break;case "en-NZ":"answers"!==g&&"answers-vertical"!==g||(a+="-vertical_ss");"movie-web-backfill"===g&&(a+="-uh_ss");break;case "zh-HK":case "zh-Hant-HK":switch(g){case "web":a+="-ura";this._urlSupportsTrending=!0;break;case "dictionary":case "shopping-vertical":a+="-vertical_ss"}break;
case "zh-TW":case "zh-Hant-TW":switch(g){case "web":a+="-ura";this._urlSupportsTrending=!0;break;case "dictionary":case "shopping-srp-vertical":case "shopping-mall-vertical":case "shopping-store-vertical":case "auction-vertical":case "service-vertical":case "shopping-category-vertical":case "shopping-store-category-vertical":case "auction-category-vertical":a+="-vertical_ss"}break;case "en-GB":case "cy-GB":switch(g){case "web":a+="-ura";this._urlSupportsTrending=!0;break;case "movie-vertical":case "answers":case "answers-vertical":a+=
"-vertical_ss";break;case "movie-web-backfill":a+="-uh_ss"}break;case "es-US":a=b+"://"+e+".search.yahoo.com/sugg/gossip/gossip-e1";"answers"!==g&&"answers-vertical"!==g||(a+="-vertical_ss");break;default:c.log("default case, no special url treatment for this property and language","info")}return c.log("gossip url:"+a,"debug",f),a+"/"},setMarket:function(){var a=this.get("lang"),b=a.split("-"),d="",e=b.length;c.Lang.isArray(b)&&0<e&&b[e-1]&&(d=b[e-1]);"fr-CA"===a&&(d="QC");"en-GB"!==a&&"cy-GB"!==
a||(d="UK");"es-US"===a&&(d="ESPANOL");"en-MY"!==a&&"ms-MY"!==a||(d="MALAYSIA");p[d]||(c.log("invalid market:"+d,"warn",f),c.log("available markets:"+p,"warn"),!1)||(d="us");this.set("market",d.toLowerCase())}})},"0.0.1",{requires:["base","cookie","intl"]});
